var gn=Object.defineProperty;var Ns=l=>{throw TypeError(l)};var bn=(l,e,s)=>e in l?gn(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var _=(l,e,s)=>bn(l,typeof e!="symbol"?e+"":e,s),yn=(l,e,s)=>e.has(l)||Ns("Cannot "+s);var vs=(l,e,s)=>e.has(l)?Ns("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(l):e.set(l,s);var vt=(l,e,s)=>(yn(l,e,"access private method"),s);import{r as j,a as wn,b as S}from"./vendor-Gm9i_4Ku.js";import{O as kn,L as ae,u as Nn,a as es,R as vn,b as tt,B as jn}from"./router-C-DkBzJ2.js";import{B as Zt,S as Rt,U as Sn,a as Tn,C as En,D as An,b as _n,P as Hs,X as de,A as Bs,c as Cn,L as Rn,d as js,e as Ss,f as jt,M as St,g as In,I as Ln,h as Dn,i as On,j as Mn,E as Ts,k as Es}from"./ui-SI4OosHX.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();var Gs={exports:{}},Ot={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pn=j,zn=Symbol.for("react.element"),$n=Symbol.for("react.fragment"),Un=Object.prototype.hasOwnProperty,Fn=Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Hn={key:!0,ref:!0,__self:!0,__source:!0};function Ws(l,e,s){var t,r={},a=null,i=null;s!==void 0&&(a=""+s),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(t in e)Un.call(e,t)&&!Hn.hasOwnProperty(t)&&(r[t]=e[t]);if(l&&l.defaultProps)for(t in e=l.defaultProps,e)r[t]===void 0&&(r[t]=e[t]);return{$$typeof:zn,type:l,key:a,ref:i,props:r,_owner:Fn.current}}Ot.Fragment=$n;Ot.jsx=Ws;Ot.jsxs=Ws;Gs.exports=Ot;var n=Gs.exports,Yt={},As=wn;Yt.createRoot=As.createRoot,Yt.hydrateRoot=As.hydrateRoot;const qs=j.createContext(void 0),Mt=()=>{const l=j.useContext(qs);if(l===void 0)throw new Error("useAuth must be used within an AuthProvider");return l},Bn=({children:l})=>{const[e,s]=j.useState(null),[t,r]=j.useState(!0);j.useEffect(()=>{const p=localStorage.getItem("mockUser");p&&s(JSON.parse(p)),r(!1)},[]);const h={user:e,loading:t,signIn:async(p,x)=>{const f={uid:"mock-user-id",email:p,displayName:p.split("@")[0],photoURL:null};s(f),localStorage.setItem("mockUser",JSON.stringify(f))},signUp:async(p,x,f)=>{const y={uid:"mock-user-id",email:p,displayName:f,photoURL:null};s(y),localStorage.setItem("mockUser",JSON.stringify(y))},signOut:async()=>{s(null),localStorage.removeItem("mockUser")},signInWithGoogle:async()=>{const p={uid:"mock-google-user-id",email:"user@gmail.com",displayName:"Google User",photoURL:"https://via.placeholder.com/40"};s(p),localStorage.setItem("mockUser",JSON.stringify(p))}};return n.jsx(qs.Provider,{value:h,children:l})},Gn=()=>n.jsx("div",{className:"min-h-screen",children:n.jsx(kn,{})});function Zs(l){var e,s,t="";if(typeof l=="string"||typeof l=="number")t+=l;else if(typeof l=="object")if(Array.isArray(l)){var r=l.length;for(e=0;e<r;e++)l[e]&&(s=Zs(l[e]))&&(t&&(t+=" "),t+=s)}else for(s in l)l[s]&&(t&&(t+=" "),t+=s);return t}function ts(){for(var l,e,s=0,t="",r=arguments.length;s<r;s++)(l=arguments[s])&&(e=Zs(l))&&(t&&(t+=" "),t+=e);return t}const H=({variant:l="primary",size:e="md",children:s,className:t,...r})=>{const a="inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",i={primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-primary-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-primary-500"},c={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"};return n.jsx("button",{className:ts(a,i[l],c[e],t),...r,children:s})},Wn=()=>n.jsxs("div",{className:"min-h-screen",children:[n.jsx("header",{className:"bg-white/80 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-50",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"flex justify-between items-center h-16",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Zt,{className:"h-8 w-8 text-primary-600"}),n.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Arcana Editor"})]}),n.jsxs("nav",{className:"hidden md:flex space-x-8",children:[n.jsx(ae,{to:"/editor",className:"text-gray-600 hover:text-primary-600 transition-colors",children:"エディター"}),n.jsx(ae,{to:"/dashboard",className:"text-gray-600 hover:text-primary-600 transition-colors",children:"ダッシュボード"})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx(ae,{to:"/login",children:n.jsx(H,{variant:"outline",size:"sm",children:"ログイン"})}),n.jsx(ae,{to:"/register",children:n.jsx(H,{size:"sm",children:"新規登録"})})]})]})})}),n.jsx("section",{className:"pt-20 pb-16 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-7xl mx-auto text-center",children:[n.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6",children:["AIが支援する",n.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-primary-600 to-purple-600",children:"シナリオエディター"})]}),n.jsx("p",{className:"text-xl text-gray-600 mb-8 max-w-3xl mx-auto",children:"クリエイティブな物語をAIの力でより豊かに。直感的なエディターで、あなたの想像力を現実に。"}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsx(ae,{to:"/editor",children:n.jsxs(H,{size:"lg",className:"w-full sm:w-auto",children:[n.jsx(Rt,{className:"mr-2 h-5 w-5"}),"エディターを始める"]})}),n.jsx("a",{href:"#features",children:n.jsx(H,{variant:"outline",size:"lg",className:"w-full sm:w-auto",children:"機能を見る"})})]})]})}),n.jsx("section",{id:"features",className:"py-16 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-16",children:[n.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"主な機能"}),n.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"AIの力を借りて、より良いシナリオを作成しましょう"})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[n.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg hover:shadow-xl transition-shadow",children:[n.jsx("div",{className:"bg-primary-100 w-16 h-16 rounded-lg flex items-center justify-center mb-6",children:n.jsx(Rt,{className:"h-8 w-8 text-primary-600"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"AI補完機能"}),n.jsx("p",{className:"text-gray-600",children:"物語の続きをAIが提案。創作の手が止まった時も、AIがあなたの創作活動をサポートします。"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg hover:shadow-xl transition-shadow",children:[n.jsx("div",{className:"bg-primary-100 w-16 h-16 rounded-lg flex items-center justify-center mb-6",children:n.jsx(Sn,{className:"h-8 w-8 text-primary-600"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"コラボレーション"}),n.jsx("p",{className:"text-gray-600",children:"チームでの共同編集が可能。リアルタイムで複数人でのシナリオ作成をサポートします。"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg hover:shadow-xl transition-shadow",children:[n.jsx("div",{className:"bg-primary-100 w-16 h-16 rounded-lg flex items-center justify-center mb-6",children:n.jsx(Tn,{className:"h-8 w-8 text-primary-600"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"セキュアな保存"}),n.jsx("p",{className:"text-gray-600",children:"Firebaseの強力なセキュリティで、あなたの作品を安全に保存・管理します。"})]})]})]})}),n.jsx("footer",{className:"bg-gray-900 text-white py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-7xl mx-auto text-center",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[n.jsx(Zt,{className:"h-6 w-6"}),n.jsx("span",{className:"text-lg font-semibold",children:"Arcana Editor"})]}),n.jsx("p",{className:"text-gray-400",children:"© 2025 Arcana Editor. All rights reserved."})]})})]}),ss=S.forwardRef(({label:l,error:e,helperText:s,className:t,id:r,...a},i)=>{const c=r||`textarea-${Math.random().toString(36).substr(2,9)}`;return n.jsxs("div",{className:"w-full",children:[l&&n.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-gray-700 mb-2",children:l}),n.jsx("textarea",{ref:i,id:c,className:ts("w-full px-3 py-2 border rounded-lg shadow-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 resize-vertical",e?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500",t),...a}),e&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:e}),s&&!e&&n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:s})]})}),fe=({label:l,error:e,helperText:s,className:t,id:r,...a})=>{const i=r||`input-${Math.random().toString(36).substr(2,9)}`;return n.jsxs("div",{className:"w-full",children:[l&&n.jsx("label",{htmlFor:i,className:"block text-sm font-medium text-gray-700 mb-2",children:l}),n.jsx("input",{id:i,className:ts("w-full px-3 py-2 border rounded-lg shadow-sm transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",e?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-primary-500",t),...a}),e&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:e}),s&&!e&&n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:s})]})},Ys=({size:l="md",className:e=""})=>{const s={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return n.jsx("div",{className:`flex items-center justify-center ${e}`,children:n.jsx("div",{className:`${s[l]} animate-spin rounded-full border-b-2 border-primary-600`})})},qn=["主人公は立ち上がり、決意を込めて言った。","その時、不思議な光が現れて、状況を一変させた。","彼女の心に新しい希望が芽生え始めていた。","謎めいた影が近づいてくる。","突然、雷鳴が轟き、空が暗くなった。","古い城の扉がきしみながら開いた。","魔法の剣が光り始めた。","風が物語を運んでくる。","星が瞬いて、新しい冒険を予感させる。","時間が止まったような静寂が訪れた。"],Zn=[{id:"1",title:"冒険の始まり",content:`主人公のアレックスは小さな村で平凡な生活を送っていた。毎日同じような日々が続き、何か変化を求めていた。

ある朝、村の外れで不思議な光を発する石を発見した。その石に触れた瞬間、世界が一変した。

「これは...魔法の石？」アレックスは呟いた。

その時、石から声が聞こえてきた。「選ばれし者よ、君の冒険が今始まる...」`,createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-20"),tags:["冒険","ファンタジー","魔法"],isPublic:!0,authorId:"mock-user-id",dictionaryEntries:[]},{id:"2",title:"謎の遺跡",content:`考古学者のサラは古代の遺跡で不思議な発見をした。壁に刻まれた文字は、これまで見たことのない言語だった。

「この文字...古代エジプトとも、マヤ文明とも違う」サラは顕微鏡で文字を詳しく調べた。

突然、遺跡の奥から光が差し込んだ。それは自然光ではない。人工的な光だった。

「誰かいるのか？」サラは懐中電灯を手に取り、光の方向へ歩き始めた。`,createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-18"),tags:["ミステリー","古代","考古学"],isPublic:!1,authorId:"mock-user-id",dictionaryEntries:[]},{id:"3",title:"宇宙の旅人",content:`宇宙船パイオニア号は未知の惑星に向かっていた。船長のケンは地球を離れてから3年が経過していた。

「地球からの最後の通信から6ヶ月が経った」ケンは航海日誌に記録した。

その時、船の警報システムが作動した。「未知の物体が接近中」という警告音が響いた。

ケンはスクリーンを見つめた。そこには、これまで見たことのない巨大な宇宙船が映し出されていた。`,createdAt:new Date("2024-01-05"),updatedAt:new Date("2024-01-12"),tags:["SF","宇宙","冒険"],isPublic:!0,authorId:"mock-user-id",dictionaryEntries:[]}];class Yn{constructor(){_(this,"scenarios",[...Zn]);this.loadFromLocalStorage()}getUserScenarios(e){return this.scenarios.filter(s=>s.authorId===e)}getScenario(e){return this.scenarios.find(s=>s.id===e)||null}createScenario(e){const s={...e,dictionaryEntries:e.dictionaryEntries??[],id:Date.now().toString(),createdAt:new Date,updatedAt:new Date};return this.scenarios.push(s),this.saveToLocalStorage(),s.id}updateScenario(e,s){const t=this.scenarios.findIndex(r=>r.id===e);t!==-1&&(this.scenarios[t]={...this.scenarios[t],...s,updatedAt:new Date},this.saveToLocalStorage())}addDictionaryEntry(e,s){const t=this.getScenario(e);if(!t)return null;const r={id:Date.now().toString(),...s,createdAt:new Date},a=t.dictionaryEntries??[];return t.dictionaryEntries=[...a,r],this.updateScenario(e,{dictionaryEntries:t.dictionaryEntries}),r}removeDictionaryEntry(e,s){const t=this.getScenario(e);!t||!t.dictionaryEntries||(t.dictionaryEntries=t.dictionaryEntries.filter(r=>r.id!==s),this.updateScenario(e,{dictionaryEntries:t.dictionaryEntries}))}updateDictionaryEntry(e,s,t){const r=this.getScenario(e);return!r||!r.dictionaryEntries?null:(r.dictionaryEntries=r.dictionaryEntries.map(a=>a.id===s?{...a,term:t.term,description:t.description}:a),this.updateScenario(e,{dictionaryEntries:r.dictionaryEntries}),r.dictionaryEntries.find(a=>a.id===s)??null)}deleteScenario(e){this.scenarios=this.scenarios.filter(s=>s.id!==e),this.saveToLocalStorage()}getPublicScenarios(){return this.scenarios.filter(e=>e.isPublic)}generateAISuggestions(){return[...qn].sort(()=>.5-Math.random()).slice(0,5)}loadFromLocalStorage(){const e=localStorage.getItem("mockScenarios");if(e)try{const s=JSON.parse(e);this.scenarios=s.map(t=>({...t,createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt),dictionaryEntries:(t.dictionaryEntries??[]).map(r=>({...r,createdAt:new Date(r.createdAt)}))}))}catch(s){console.error("Error loading scenarios from localStorage:",s)}}saveToLocalStorage(){localStorage.setItem("mockScenarios",JSON.stringify(this.scenarios))}}const re=new Yn,Xn=({initialContent:l="",onSave:e})=>{const{user:s}=Mt(),[t,r]=j.useState(l),[a,i]=j.useState(""),[c,d]=j.useState([]),[h,p]=j.useState(""),[x,f]=j.useState(!1),[y,M]=j.useState([]),[R,W]=j.useState(!1),[Z,P]=j.useState(0),[I,L]=j.useState(null),z=j.useRef(null),Te=async()=>{W(!0);try{await new Promise(Y=>setTimeout(Y,1500));const k=re.generateAISuggestions();M(k)}catch(k){console.error("AI completion error:",k)}finally{W(!1)}},Me=k=>{r(k.target.value),P(k.target.selectionStart)},qe=()=>{z.current&&P(z.current.selectionStart)},Ze=k=>{const Y=t.substring(0,Z),ue=t.substring(Z),se=Y+k+ue;r(se),M([]),setTimeout(()=>{if(z.current){const he=Z+k.length;z.current.focus(),z.current.setSelectionRange(he,he)}},100)},Ye=()=>{h.trim()&&!c.includes(h.trim())&&(d([...c,h.trim()]),p(""))},$=k=>{d(c.filter(Y=>Y!==k))},Ee=()=>{if(!s){alert("ログインが必要です");return}try{if(I)re.updateScenario(I,{title:a,content:t,tags:c,isPublic:x});else{const k=re.createScenario({title:a||"無題のシナリオ",content:t,tags:c,isPublic:x,authorId:s.uid});L(k)}e&&e({title:a,content:t,tags:c,isPublic:x}),alert("シナリオが保存されました！")}catch(k){console.error("Save error:",k),alert("保存に失敗しました")}},ye=async()=>{try{await navigator.clipboard.writeText(t),alert("クリップボードにコピーしました")}catch(k){console.error("Copy failed:",k)}},Ae=()=>{const k=JSON.stringify({title:a,content:t,tags:c,isPublic:x,timestamp:new Date().toISOString()},null,2),Y=new Blob([k],{type:"application/json"}),ue=URL.createObjectURL(Y),se=document.createElement("a");se.href=ue,se.download=`${a||"scenario"}.json`,se.click(),URL.revokeObjectURL(ue)};return n.jsxs("div",{className:"max-w-5xl mx-auto p-4 sm:p-6 lg:p-8 space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"シナリオエディター"}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(H,{variant:"outline",size:"sm",onClick:ye,className:"flex-1 sm:flex-none",children:[n.jsx(En,{className:"h-4 w-4 mr-2"}),"コピー"]}),n.jsxs(H,{variant:"outline",size:"sm",onClick:Ae,className:"flex-1 sm:flex-none",children:[n.jsx(An,{className:"h-4 w-4 mr-2"}),"エクスポート"]}),n.jsxs(H,{size:"sm",onClick:Ee,className:"flex-1 sm:flex-none",children:[n.jsx(_n,{className:"h-4 w-4 mr-2"}),"保存"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(fe,{label:"タイトル",value:a,onChange:k=>i(k.target.value),placeholder:"シナリオのタイトルを入力"}),n.jsx("div",{className:"flex items-center space-x-4",children:n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",checked:x,onChange:k=>f(k.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),n.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"公開"})]})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"タグ"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:c.map((k,Y)=>n.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary-100 text-primary-800",children:[k,n.jsx("button",{onClick:()=>$(k),className:"ml-2 text-primary-600 hover:text-primary-800",children:"×"})]},Y))}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsx(fe,{value:h,onChange:k=>p(k.target.value),placeholder:"新しいタグを入力",onKeyPress:k=>k.key==="Enter"&&Ye()}),n.jsx(H,{variant:"outline",onClick:Ye,children:n.jsx(Hs,{className:"h-4 w-4"})})]})]}),n.jsxs("div",{className:"bg-gradient-to-r from-purple-50 via-blue-50 to-indigo-50 p-6 rounded-xl border border-purple-100 shadow-sm",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-4",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[n.jsx(Rt,{className:"h-5 w-5 mr-2 text-purple-600 animate-pulse"}),"AI補完"]}),n.jsx(H,{variant:"outline",size:"sm",onClick:()=>Te(),disabled:R,className:"w-full sm:w-auto",children:R?n.jsxs(n.Fragment,{children:[n.jsx(Ys,{size:"sm",className:"mr-2"}),"生成中..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Rt,{className:"h-4 w-4 mr-2"}),"続きを生成"]})})]}),y.length>0&&n.jsxs("div",{className:"space-y-3 mt-4",children:[n.jsx("p",{className:"text-sm font-medium text-gray-700",children:"以下の提案から選択してください："}),n.jsx("div",{className:"grid gap-3",children:y.map((k,Y)=>n.jsx("div",{className:"bg-white p-4 rounded-lg border-2 border-purple-200 hover:border-purple-400 cursor-pointer transition-all shadow-sm hover:shadow-md",onClick:()=>Ze(k),children:n.jsx("p",{className:"text-gray-800 leading-relaxed",children:k})},Y))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"シナリオ内容"}),n.jsx(ss,{ref:z,value:t,onChange:Me,onSelect:qe,onFocus:qe,placeholder:"シナリオの内容を入力してください...",className:"min-h-96 font-mono text-base leading-relaxed"}),n.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["文字数: ",t.length," | カーソル位置: ",Z]})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"統計情報"}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"文字数:"}),n.jsx("span",{className:"ml-2 font-medium",children:t.length})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"単語数:"}),n.jsx("span",{className:"ml-2 font-medium",children:t.split(/\s+/).filter(k=>k.length>0).length})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"行数:"}),n.jsx("span",{className:"ml-2 font-medium",children:t.split(`
`).length})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"段落数:"}),n.jsx("span",{className:"ml-2 font-medium",children:t.split(`

`).filter(k=>k.trim().length>0).length})]})]})]})]})},Kn=()=>{const[l]=Nn(),[e,s]=j.useState(""),t=l.get("id");j.useEffect(()=>{if(t){const a=re.getScenario(t);a&&s(a.content)}},[t]);const r=a=>{console.log("Saving scenario:",a)};return n.jsx("div",{className:"min-h-screen",children:n.jsx(Xn,{initialContent:e,onSave:r})})},Vn=({isOpen:l,onClose:e,onSave:s})=>{const[t,r]=j.useState(""),[a,i]=j.useState(!1),[c,d]=j.useState(!1);j.useEffect(()=>{if(l){const p=localStorage.getItem("apiKey")||"",x=localStorage.getItem("useShortcutKeys")==="true",f=localStorage.getItem("dontSaveAIHistory")==="true";r(p),i(x),d(f)}},[l]);const h=()=>{const p={apiKey:t,useShortcutKeys:a,dontSaveAIHistory:c};localStorage.setItem("apiKey",t),localStorage.setItem("useShortcutKeys",a.toString()),localStorage.setItem("dontSaveAIHistory",c.toString()),s(p),e()};return l?n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:n.jsxs("div",{className:"bg-blue-50 border-2 border-gray-300 rounded-lg shadow-xl w-full max-w-lg mx-4 p-8 relative",children:[n.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"閉じる",children:n.jsx(de,{className:"h-5 w-5"})}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"APIキーの入力"}),n.jsx("div",{className:"mb-6",children:n.jsx(fe,{type:"password",value:t,onChange:p=>r(p.target.value),placeholder:"APIキーを入力してください",className:"w-full h-12 text-base"})}),n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsxs("label",{className:"flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:a,onChange:p=>i(p.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),n.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"ショートカットキーを使用する"})]}),n.jsxs("label",{className:"flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:c,onChange:p=>d(p.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),n.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"AIの履歴を保存しない"})]})]}),n.jsx("div",{className:"flex justify-center",children:n.jsx(H,{onClick:h,className:"px-8",children:"設定を保存"})})]})}):null},Qn=({isOpen:l,onClose:e,onSave:s,onNext:t})=>{const[r,a]=j.useState(""),i=()=>{r.trim()&&(s(r),a(""),e())},c=()=>{r.trim()&&(t?(t(r),a(""),e()):i())},d=()=>{a(""),e()};return l?n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:n.jsxs("div",{className:"bg-blue-50 border-2 border-gray-300 rounded-lg shadow-xl w-full max-w-2xl mx-4 p-6 relative",children:[n.jsx("button",{onClick:d,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"閉じる",children:n.jsx(de,{className:"h-5 w-5"})}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"プロンプト入力"}),n.jsx("div",{className:"mb-6",children:n.jsx(ss,{value:r,onChange:h=>a(h.target.value),placeholder:"プロンプトを入力してください...",className:"w-full min-h-[300px] text-base resize-none"})}),n.jsxs("div",{className:"flex justify-between gap-4",children:[n.jsx(H,{onClick:i,variant:"outline",className:"flex-1 border border-gray-300 hover:border-gray-400",disabled:!r.trim(),children:"テキストを保存"}),n.jsxs(H,{onClick:c,className:"flex-1",disabled:!r.trim(),children:[n.jsx(Bs,{className:"h-4 w-4 mr-2"}),"次へ"]})]})]})}):null},Jn=({isOpen:l,onClose:e,onSave:s,onNext:t,mode:r="create",initialEntry:a})=>{const[i,c]=j.useState(""),[d,h]=j.useState("");S.useEffect(()=>{l&&(c((a==null?void 0:a.term)??""),h((a==null?void 0:a.description)??""))},[l,a]);const p=()=>{i.trim()&&d.trim()&&(s({term:i,description:d}),c(""),h(""),e())},x=()=>{if(r==="edit"||!t){p();return}i.trim()&&d.trim()&&(t({term:i,description:d}),c(""),h(""),e())},f=()=>{c(""),h(""),e()};return l?n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:n.jsxs("div",{className:"bg-blue-50 rounded-lg shadow-xl w-full max-w-2xl mx-4 p-6 relative",children:[n.jsx("button",{onClick:f,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"閉じる",children:n.jsx(de,{className:"h-5 w-5"})}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:r==="edit"?"辞書エントリの編集":"辞書エントリの追加"}),n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"用語"}),n.jsx(fe,{value:i,onChange:y=>c(y.target.value),placeholder:"例: 魔法石"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"詳細"}),n.jsx(ss,{value:d,onChange:y=>h(y.target.value),placeholder:"用語の説明や背景を入力してください...",className:"w-full min-h-[220px] text-base resize-none bg-blue-50"})]})]}),n.jsxs("div",{className:"flex justify-between gap-4",children:[n.jsx(H,{onClick:p,variant:"outline",className:"flex-1 border border-gray-300 hover:border-gray-400",disabled:!i.trim()||!d.trim(),children:r==="edit"?"更新する":"テキストを保存"}),r==="create"&&t&&n.jsx(H,{onClick:x,className:"flex-1",disabled:!i.trim()||!d.trim(),children:n.jsx(Bs,{className:"h-4 w-4 mr-2"})})]})]})}):null};function ns(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let We=ns();function Xs(l){We=l}const Ks=/[&<>"']/,er=new RegExp(Ks.source,"g"),Vs=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,tr=new RegExp(Vs.source,"g"),sr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_s=l=>sr[l];function te(l,e){if(e){if(Ks.test(l))return l.replace(er,_s)}else if(Vs.test(l))return l.replace(tr,_s);return l}const nr=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function rr(l){return l.replace(nr,(e,s)=>(s=s.toLowerCase(),s==="colon"?":":s.charAt(0)==="#"?s.charAt(1)==="x"?String.fromCharCode(parseInt(s.substring(2),16)):String.fromCharCode(+s.substring(1)):""))}const ar=/(^|[^\[])\^/g;function A(l,e){let s=typeof l=="string"?l:l.source;e=e||"";const t={replace:(r,a)=>{let i=typeof a=="string"?a:a.source;return i=i.replace(ar,"$1"),s=s.replace(r,i),t},getRegex:()=>new RegExp(s,e)};return t}function Cs(l){try{l=encodeURI(l).replace(/%25/g,"%")}catch{return null}return l}const ht={exec:()=>null};function Rs(l,e){const s=l.replace(/\|/g,(a,i,c)=>{let d=!1,h=i;for(;--h>=0&&c[h]==="\\";)d=!d;return d?"|":" |"}),t=s.split(/ \|/);let r=0;if(t[0].trim()||t.shift(),t.length>0&&!t[t.length-1].trim()&&t.pop(),e)if(t.length>e)t.splice(e);else for(;t.length<e;)t.push("");for(;r<t.length;r++)t[r]=t[r].trim().replace(/\\\|/g,"|");return t}function Tt(l,e,s){const t=l.length;if(t===0)return"";let r=0;for(;r<t&&l.charAt(t-r-1)===e;)r++;return l.slice(0,t-r)}function ir(l,e){if(l.indexOf(e[1])===-1)return-1;let s=0;for(let t=0;t<l.length;t++)if(l[t]==="\\")t++;else if(l[t]===e[0])s++;else if(l[t]===e[1]&&(s--,s<0))return t;return-1}function Is(l,e,s,t){const r=e.href,a=e.title?te(e.title):null,i=l[1].replace(/\\([\[\]])/g,"$1");if(l[0].charAt(0)!=="!"){t.state.inLink=!0;const c={type:"link",raw:s,href:r,title:a,text:i,tokens:t.inlineTokens(i)};return t.state.inLink=!1,c}return{type:"image",raw:s,href:r,title:a,text:te(i)}}function or(l,e){const s=l.match(/^(\s+)(?:```)/);if(s===null)return e;const t=s[1];return e.split(`
`).map(r=>{const a=r.match(/^\s+/);if(a===null)return r;const[i]=a;return i.length>=t.length?r.slice(t.length):r}).join(`
`)}class It{constructor(e){_(this,"options");_(this,"rules");_(this,"lexer");this.options=e||We}space(e){const s=this.rules.block.newline.exec(e);if(s&&s[0].length>0)return{type:"space",raw:s[0]}}code(e){const s=this.rules.block.code.exec(e);if(s){const t=s[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:s[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Tt(t,`
`)}}}fences(e){const s=this.rules.block.fences.exec(e);if(s){const t=s[0],r=or(t,s[3]||"");return{type:"code",raw:t,lang:s[2]?s[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):s[2],text:r}}}heading(e){const s=this.rules.block.heading.exec(e);if(s){let t=s[2].trim();if(/#$/.test(t)){const r=Tt(t,"#");(this.options.pedantic||!r||/ $/.test(r))&&(t=r.trim())}return{type:"heading",raw:s[0],depth:s[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(e){const s=this.rules.block.hr.exec(e);if(s)return{type:"hr",raw:s[0]}}blockquote(e){const s=this.rules.block.blockquote.exec(e);if(s){let t=s[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);t=Tt(t.replace(/^ *>[ \t]?/gm,""),`
`);const r=this.lexer.state.top;this.lexer.state.top=!0;const a=this.lexer.blockTokens(t);return this.lexer.state.top=r,{type:"blockquote",raw:s[0],tokens:a,text:t}}}list(e){let s=this.rules.block.list.exec(e);if(s){let t=s[1].trim();const r=t.length>1,a={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");const i=new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`);let c="",d="",h=!1;for(;e;){let p=!1;if(!(s=i.exec(e))||this.rules.block.hr.test(e))break;c=s[0],e=e.substring(c.length);let x=s[2].split(`
`,1)[0].replace(/^\t+/,Z=>" ".repeat(3*Z.length)),f=e.split(`
`,1)[0],y=0;this.options.pedantic?(y=2,d=x.trimStart()):(y=s[2].search(/[^ ]/),y=y>4?1:y,d=x.slice(y),y+=s[1].length);let M=!1;if(!x&&/^ *$/.test(f)&&(c+=f+`
`,e=e.substring(f.length+1),p=!0),!p){const Z=new RegExp(`^ {0,${Math.min(3,y-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),P=new RegExp(`^ {0,${Math.min(3,y-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),I=new RegExp(`^ {0,${Math.min(3,y-1)}}(?:\`\`\`|~~~)`),L=new RegExp(`^ {0,${Math.min(3,y-1)}}#`);for(;e;){const z=e.split(`
`,1)[0];if(f=z,this.options.pedantic&&(f=f.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),I.test(f)||L.test(f)||Z.test(f)||P.test(e))break;if(f.search(/[^ ]/)>=y||!f.trim())d+=`
`+f.slice(y);else{if(M||x.search(/[^ ]/)>=4||I.test(x)||L.test(x)||P.test(x))break;d+=`
`+f}!M&&!f.trim()&&(M=!0),c+=z+`
`,e=e.substring(z.length+1),x=f.slice(y)}}a.loose||(h?a.loose=!0:/\n *\n *$/.test(c)&&(h=!0));let R=null,W;this.options.gfm&&(R=/^\[[ xX]\] /.exec(d),R&&(W=R[0]!=="[ ] ",d=d.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:c,task:!!R,checked:W,loose:!1,text:d,tokens:[]}),a.raw+=c}a.items[a.items.length-1].raw=c.trimEnd(),a.items[a.items.length-1].text=d.trimEnd(),a.raw=a.raw.trimEnd();for(let p=0;p<a.items.length;p++)if(this.lexer.state.top=!1,a.items[p].tokens=this.lexer.blockTokens(a.items[p].text,[]),!a.loose){const x=a.items[p].tokens.filter(y=>y.type==="space"),f=x.length>0&&x.some(y=>/\n.*\n/.test(y.raw));a.loose=f}if(a.loose)for(let p=0;p<a.items.length;p++)a.items[p].loose=!0;return a}}html(e){const s=this.rules.block.html.exec(e);if(s)return{type:"html",block:!0,raw:s[0],pre:s[1]==="pre"||s[1]==="script"||s[1]==="style",text:s[0]}}def(e){const s=this.rules.block.def.exec(e);if(s){const t=s[1].toLowerCase().replace(/\s+/g," "),r=s[2]?s[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=s[3]?s[3].substring(1,s[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):s[3];return{type:"def",tag:t,raw:s[0],href:r,title:a}}}table(e){const s=this.rules.block.table.exec(e);if(!s||!/[:|]/.test(s[2]))return;const t=Rs(s[1]),r=s[2].replace(/^\||\| *$/g,"").split("|"),a=s[3]&&s[3].trim()?s[3].replace(/\n[ \t]*$/,"").split(`
`):[],i={type:"table",raw:s[0],header:[],align:[],rows:[]};if(t.length===r.length){for(const c of r)/^ *-+: *$/.test(c)?i.align.push("right"):/^ *:-+: *$/.test(c)?i.align.push("center"):/^ *:-+ *$/.test(c)?i.align.push("left"):i.align.push(null);for(const c of t)i.header.push({text:c,tokens:this.lexer.inline(c)});for(const c of a)i.rows.push(Rs(c,i.header.length).map(d=>({text:d,tokens:this.lexer.inline(d)})));return i}}lheading(e){const s=this.rules.block.lheading.exec(e);if(s)return{type:"heading",raw:s[0],depth:s[2].charAt(0)==="="?1:2,text:s[1],tokens:this.lexer.inline(s[1])}}paragraph(e){const s=this.rules.block.paragraph.exec(e);if(s){const t=s[1].charAt(s[1].length-1)===`
`?s[1].slice(0,-1):s[1];return{type:"paragraph",raw:s[0],text:t,tokens:this.lexer.inline(t)}}}text(e){const s=this.rules.block.text.exec(e);if(s)return{type:"text",raw:s[0],text:s[0],tokens:this.lexer.inline(s[0])}}escape(e){const s=this.rules.inline.escape.exec(e);if(s)return{type:"escape",raw:s[0],text:te(s[1])}}tag(e){const s=this.rules.inline.tag.exec(e);if(s)return!this.lexer.state.inLink&&/^<a /i.test(s[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(s[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(s[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(s[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:s[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:s[0]}}link(e){const s=this.rules.inline.link.exec(e);if(s){const t=s[2].trim();if(!this.options.pedantic&&/^</.test(t)){if(!/>$/.test(t))return;const i=Tt(t.slice(0,-1),"\\");if((t.length-i.length)%2===0)return}else{const i=ir(s[2],"()");if(i>-1){const d=(s[0].indexOf("!")===0?5:4)+s[1].length+i;s[2]=s[2].substring(0,i),s[0]=s[0].substring(0,d).trim(),s[3]=""}}let r=s[2],a="";if(this.options.pedantic){const i=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);i&&(r=i[1],a=i[3])}else a=s[3]?s[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(t)?r=r.slice(1):r=r.slice(1,-1)),Is(s,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},s[0],this.lexer)}}reflink(e,s){let t;if((t=this.rules.inline.reflink.exec(e))||(t=this.rules.inline.nolink.exec(e))){const r=(t[2]||t[1]).replace(/\s+/g," "),a=s[r.toLowerCase()];if(!a){const i=t[0].charAt(0);return{type:"text",raw:i,text:i}}return Is(t,a,t[0],this.lexer)}}emStrong(e,s,t=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&t.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const i=[...r[0]].length-1;let c,d,h=i,p=0;const x=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(x.lastIndex=0,s=s.slice(-1*e.length+i);(r=x.exec(s))!=null;){if(c=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!c)continue;if(d=[...c].length,r[3]||r[4]){h+=d;continue}else if((r[5]||r[6])&&i%3&&!((i+d)%3)){p+=d;continue}if(h-=d,h>0)continue;d=Math.min(d,d+h+p);const f=[...r[0]][0].length,y=e.slice(0,i+r.index+f+d);if(Math.min(i,d)%2){const R=y.slice(1,-1);return{type:"em",raw:y,text:R,tokens:this.lexer.inlineTokens(R)}}const M=y.slice(2,-2);return{type:"strong",raw:y,text:M,tokens:this.lexer.inlineTokens(M)}}}}codespan(e){const s=this.rules.inline.code.exec(e);if(s){let t=s[2].replace(/\n/g," ");const r=/[^ ]/.test(t),a=/^ /.test(t)&&/ $/.test(t);return r&&a&&(t=t.substring(1,t.length-1)),t=te(t,!0),{type:"codespan",raw:s[0],text:t}}}br(e){const s=this.rules.inline.br.exec(e);if(s)return{type:"br",raw:s[0]}}del(e){const s=this.rules.inline.del.exec(e);if(s)return{type:"del",raw:s[0],text:s[2],tokens:this.lexer.inlineTokens(s[2])}}autolink(e){const s=this.rules.inline.autolink.exec(e);if(s){let t,r;return s[2]==="@"?(t=te(s[1]),r="mailto:"+t):(t=te(s[1]),r=t),{type:"link",raw:s[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(e){var t;let s;if(s=this.rules.inline.url.exec(e)){let r,a;if(s[2]==="@")r=te(s[0]),a="mailto:"+r;else{let i;do i=s[0],s[0]=((t=this.rules.inline._backpedal.exec(s[0]))==null?void 0:t[0])??"";while(i!==s[0]);r=te(s[0]),s[1]==="www."?a="http://"+s[0]:a=s[0]}return{type:"link",raw:s[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const s=this.rules.inline.text.exec(e);if(s){let t;return this.lexer.state.inRawBlock?t=s[0]:t=te(s[0]),{type:"text",raw:s[0],text:t}}}}const lr=/^(?: *(?:\n|$))+/,cr=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,dr=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,mt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,ur=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Qs=/(?:[*+-]|\d{1,9}[.)])/,Js=A(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Qs).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),rs=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,hr=/^[^\n]+/,as=/(?!\s*\])(?:\\.|[^\[\]\\])+/,pr=A(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",as).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),mr=A(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Qs).getRegex(),Pt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",is=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,xr=A("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",is).replace("tag",Pt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),en=A(rs).replace("hr",mt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pt).getRegex(),fr=A(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",en).getRegex(),os={blockquote:fr,code:cr,def:pr,fences:dr,heading:ur,hr:mt,html:xr,lheading:Js,list:mr,newline:lr,paragraph:en,table:ht,text:hr},Ls=A("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",mt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pt).getRegex(),gr={...os,table:Ls,paragraph:A(rs).replace("hr",mt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ls).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pt).getRegex()},br={...os,html:A(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",is).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ht,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:A(rs).replace("hr",mt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Js).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},tn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,yr=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,sn=/^( {2,}|\\)\n(?!\s*$)/,wr=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,xt="\\p{P}\\p{S}",kr=A(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,xt).getRegex(),Nr=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,vr=A(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,xt).getRegex(),jr=A("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,xt).getRegex(),Sr=A("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,xt).getRegex(),Tr=A(/\\([punct])/,"gu").replace(/punct/g,xt).getRegex(),Er=A(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ar=A(is).replace("(?:-->|$)","-->").getRegex(),_r=A("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ar).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Lt=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Cr=A(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Lt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),nn=A(/^!?\[(label)\]\[(ref)\]/).replace("label",Lt).replace("ref",as).getRegex(),rn=A(/^!?\[(ref)\](?:\[\])?/).replace("ref",as).getRegex(),Rr=A("reflink|nolink(?!\\()","g").replace("reflink",nn).replace("nolink",rn).getRegex(),ls={_backpedal:ht,anyPunctuation:Tr,autolink:Er,blockSkip:Nr,br:sn,code:yr,del:ht,emStrongLDelim:vr,emStrongRDelimAst:jr,emStrongRDelimUnd:Sr,escape:tn,link:Cr,nolink:rn,punctuation:kr,reflink:nn,reflinkSearch:Rr,tag:_r,text:wr,url:ht},Ir={...ls,link:A(/^!?\[(label)\]\((.*?)\)/).replace("label",Lt).getRegex(),reflink:A(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Lt).getRegex()},Xt={...ls,escape:A(tn).replace("])","~|])").getRegex(),url:A(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Lr={...Xt,br:A(sn).replace("{2,}","*").getRegex(),text:A(Xt.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Et={normal:os,gfm:gr,pedantic:br},it={normal:ls,gfm:Xt,breaks:Lr,pedantic:Ir};class ge{constructor(e){_(this,"tokens");_(this,"options");_(this,"state");_(this,"tokenizer");_(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||We,this.options.tokenizer=this.options.tokenizer||new It,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const s={block:Et.normal,inline:it.normal};this.options.pedantic?(s.block=Et.pedantic,s.inline=it.pedantic):this.options.gfm&&(s.block=Et.gfm,this.options.breaks?s.inline=it.breaks:s.inline=it.gfm),this.tokenizer.rules=s}static get rules(){return{block:Et,inline:it}}static lex(e,s){return new ge(s).lex(e)}static lexInline(e,s){return new ge(s).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let s=0;s<this.inlineQueue.length;s++){const t=this.inlineQueue[s];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,s=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(c,d,h)=>d+"    ".repeat(h.length));let t,r,a,i;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(c=>(t=c.call({lexer:this},e,s))?(e=e.substring(t.raw.length),s.push(t),!0):!1))){if(t=this.tokenizer.space(e)){e=e.substring(t.raw.length),t.raw.length===1&&s.length>0?s[s.length-1].raw+=`
`:s.push(t);continue}if(t=this.tokenizer.code(e)){e=e.substring(t.raw.length),r=s[s.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+t.raw,r.text+=`
`+t.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):s.push(t);continue}if(t=this.tokenizer.fences(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.heading(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.hr(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.blockquote(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.list(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.html(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.def(e)){e=e.substring(t.raw.length),r=s[s.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+t.raw,r.text+=`
`+t.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[t.tag]||(this.tokens.links[t.tag]={href:t.href,title:t.title});continue}if(t=this.tokenizer.table(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.lheading(e)){e=e.substring(t.raw.length),s.push(t);continue}if(a=e,this.options.extensions&&this.options.extensions.startBlock){let c=1/0;const d=e.slice(1);let h;this.options.extensions.startBlock.forEach(p=>{h=p.call({lexer:this},d),typeof h=="number"&&h>=0&&(c=Math.min(c,h))}),c<1/0&&c>=0&&(a=e.substring(0,c+1))}if(this.state.top&&(t=this.tokenizer.paragraph(a))){r=s[s.length-1],i&&r.type==="paragraph"?(r.raw+=`
`+t.raw,r.text+=`
`+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):s.push(t),i=a.length!==e.length,e=e.substring(t.raw.length);continue}if(t=this.tokenizer.text(e)){e=e.substring(t.raw.length),r=s[s.length-1],r&&r.type==="text"?(r.raw+=`
`+t.raw,r.text+=`
`+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):s.push(t);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,s}inline(e,s=[]){return this.inlineQueue.push({src:e,tokens:s}),s}inlineTokens(e,s=[]){let t,r,a,i=e,c,d,h;if(this.tokens.links){const p=Object.keys(this.tokens.links);if(p.length>0)for(;(c=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)p.includes(c[0].slice(c[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(c=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(c=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,c.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(d||(h=""),d=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(p=>(t=p.call({lexer:this},e,s))?(e=e.substring(t.raw.length),s.push(t),!0):!1))){if(t=this.tokenizer.escape(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.tag(e)){e=e.substring(t.raw.length),r=s[s.length-1],r&&t.type==="text"&&r.type==="text"?(r.raw+=t.raw,r.text+=t.text):s.push(t);continue}if(t=this.tokenizer.link(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(t.raw.length),r=s[s.length-1],r&&t.type==="text"&&r.type==="text"?(r.raw+=t.raw,r.text+=t.text):s.push(t);continue}if(t=this.tokenizer.emStrong(e,i,h)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.codespan(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.br(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.del(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.autolink(e)){e=e.substring(t.raw.length),s.push(t);continue}if(!this.state.inLink&&(t=this.tokenizer.url(e))){e=e.substring(t.raw.length),s.push(t);continue}if(a=e,this.options.extensions&&this.options.extensions.startInline){let p=1/0;const x=e.slice(1);let f;this.options.extensions.startInline.forEach(y=>{f=y.call({lexer:this},x),typeof f=="number"&&f>=0&&(p=Math.min(p,f))}),p<1/0&&p>=0&&(a=e.substring(0,p+1))}if(t=this.tokenizer.inlineText(a)){e=e.substring(t.raw.length),t.raw.slice(-1)!=="_"&&(h=t.raw.slice(-1)),d=!0,r=s[s.length-1],r&&r.type==="text"?(r.raw+=t.raw,r.text+=t.text):s.push(t);continue}if(e){const p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return s}}class Dt{constructor(e){_(this,"options");this.options=e||We}code(e,s,t){var a;const r=(a=(s||"").match(/^\S*/))==null?void 0:a[0];return e=e.replace(/\n$/,"")+`
`,r?'<pre><code class="language-'+te(r)+'">'+(t?e:te(e,!0))+`</code></pre>
`:"<pre><code>"+(t?e:te(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,s){return e}heading(e,s,t){return`<h${s}>${e}</h${s}>
`}hr(){return`<hr>
`}list(e,s,t){const r=s?"ol":"ul",a=s&&t!==1?' start="'+t+'"':"";return"<"+r+a+`>
`+e+"</"+r+`>
`}listitem(e,s,t){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,s){return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+s+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,s){const t=s.header?"th":"td";return(s.align?`<${t} align="${s.align}">`:`<${t}>`)+e+`</${t}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,s,t){const r=Cs(e);if(r===null)return t;e=r;let a='<a href="'+e+'"';return s&&(a+=' title="'+s+'"'),a+=">"+t+"</a>",a}image(e,s,t){const r=Cs(e);if(r===null)return t;e=r;let a=`<img src="${e}" alt="${t}"`;return s&&(a+=` title="${s}"`),a+=">",a}text(e){return e}}class cs{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,s,t){return""+t}image(e,s,t){return""+t}br(){return""}}class be{constructor(e){_(this,"options");_(this,"renderer");_(this,"textRenderer");this.options=e||We,this.options.renderer=this.options.renderer||new Dt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new cs}static parse(e,s){return new be(s).parse(e)}static parseInline(e,s){return new be(s).parseInline(e)}parse(e,s=!0){let t="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const i=a,c=this.options.extensions.renderers[i.type].call({parser:this},i);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(i.type)){t+=c||"";continue}}switch(a.type){case"space":continue;case"hr":{t+=this.renderer.hr();continue}case"heading":{const i=a;t+=this.renderer.heading(this.parseInline(i.tokens),i.depth,rr(this.parseInline(i.tokens,this.textRenderer)));continue}case"code":{const i=a;t+=this.renderer.code(i.text,i.lang,!!i.escaped);continue}case"table":{const i=a;let c="",d="";for(let p=0;p<i.header.length;p++)d+=this.renderer.tablecell(this.parseInline(i.header[p].tokens),{header:!0,align:i.align[p]});c+=this.renderer.tablerow(d);let h="";for(let p=0;p<i.rows.length;p++){const x=i.rows[p];d="";for(let f=0;f<x.length;f++)d+=this.renderer.tablecell(this.parseInline(x[f].tokens),{header:!1,align:i.align[f]});h+=this.renderer.tablerow(d)}t+=this.renderer.table(c,h);continue}case"blockquote":{const i=a,c=this.parse(i.tokens);t+=this.renderer.blockquote(c);continue}case"list":{const i=a,c=i.ordered,d=i.start,h=i.loose;let p="";for(let x=0;x<i.items.length;x++){const f=i.items[x],y=f.checked,M=f.task;let R="";if(f.task){const W=this.renderer.checkbox(!!y);h?f.tokens.length>0&&f.tokens[0].type==="paragraph"?(f.tokens[0].text=W+" "+f.tokens[0].text,f.tokens[0].tokens&&f.tokens[0].tokens.length>0&&f.tokens[0].tokens[0].type==="text"&&(f.tokens[0].tokens[0].text=W+" "+f.tokens[0].tokens[0].text)):f.tokens.unshift({type:"text",text:W+" "}):R+=W+" "}R+=this.parse(f.tokens,h),p+=this.renderer.listitem(R,M,!!y)}t+=this.renderer.list(p,c,d);continue}case"html":{const i=a;t+=this.renderer.html(i.text,i.block);continue}case"paragraph":{const i=a;t+=this.renderer.paragraph(this.parseInline(i.tokens));continue}case"text":{let i=a,c=i.tokens?this.parseInline(i.tokens):i.text;for(;r+1<e.length&&e[r+1].type==="text";)i=e[++r],c+=`
`+(i.tokens?this.parseInline(i.tokens):i.text);t+=s?this.renderer.paragraph(c):c;continue}default:{const i='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return t}parseInline(e,s){s=s||this.renderer;let t="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const i=this.options.extensions.renderers[a.type].call({parser:this},a);if(i!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){t+=i||"";continue}}switch(a.type){case"escape":{const i=a;t+=s.text(i.text);break}case"html":{const i=a;t+=s.html(i.text);break}case"link":{const i=a;t+=s.link(i.href,i.title,this.parseInline(i.tokens,s));break}case"image":{const i=a;t+=s.image(i.href,i.title,i.text);break}case"strong":{const i=a;t+=s.strong(this.parseInline(i.tokens,s));break}case"em":{const i=a;t+=s.em(this.parseInline(i.tokens,s));break}case"codespan":{const i=a;t+=s.codespan(i.text);break}case"br":{t+=s.br();break}case"del":{const i=a;t+=s.del(this.parseInline(i.tokens,s));break}case"text":{const i=a;t+=s.text(i.text);break}default:{const i='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return t}}class pt{constructor(e){_(this,"options");this.options=e||We}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}_(pt,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var Ge,Kt,an;class Dr{constructor(...e){vs(this,Ge);_(this,"defaults",ns());_(this,"options",this.setOptions);_(this,"parse",vt(this,Ge,Kt).call(this,ge.lex,be.parse));_(this,"parseInline",vt(this,Ge,Kt).call(this,ge.lexInline,be.parseInline));_(this,"Parser",be);_(this,"Renderer",Dt);_(this,"TextRenderer",cs);_(this,"Lexer",ge);_(this,"Tokenizer",It);_(this,"Hooks",pt);this.use(...e)}walkTokens(e,s){var r,a;let t=[];for(const i of e)switch(t=t.concat(s.call(this,i)),i.type){case"table":{const c=i;for(const d of c.header)t=t.concat(this.walkTokens(d.tokens,s));for(const d of c.rows)for(const h of d)t=t.concat(this.walkTokens(h.tokens,s));break}case"list":{const c=i;t=t.concat(this.walkTokens(c.items,s));break}default:{const c=i;(a=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&a[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{const h=c[d].flat(1/0);t=t.concat(this.walkTokens(h,s))}):c.tokens&&(t=t.concat(this.walkTokens(c.tokens,s)))}}return t}use(...e){const s=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(t=>{const r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const i=s.renderers[a.name];i?s.renderers[a.name]=function(...c){let d=a.renderer.apply(this,c);return d===!1&&(d=i.apply(this,c)),d}:s.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=s[a.level];i?i.unshift(a.tokenizer):s[a.level]=[a.tokenizer],a.start&&(a.level==="block"?s.startBlock?s.startBlock.push(a.start):s.startBlock=[a.start]:a.level==="inline"&&(s.startInline?s.startInline.push(a.start):s.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(s.childTokens[a.name]=a.childTokens)}),r.extensions=s),t.renderer){const a=this.defaults.renderer||new Dt(this.defaults);for(const i in t.renderer){if(!(i in a))throw new Error(`renderer '${i}' does not exist`);if(i==="options")continue;const c=i,d=t.renderer[c],h=a[c];a[c]=(...p)=>{let x=d.apply(a,p);return x===!1&&(x=h.apply(a,p)),x||""}}r.renderer=a}if(t.tokenizer){const a=this.defaults.tokenizer||new It(this.defaults);for(const i in t.tokenizer){if(!(i in a))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const c=i,d=t.tokenizer[c],h=a[c];a[c]=(...p)=>{let x=d.apply(a,p);return x===!1&&(x=h.apply(a,p)),x}}r.tokenizer=a}if(t.hooks){const a=this.defaults.hooks||new pt;for(const i in t.hooks){if(!(i in a))throw new Error(`hook '${i}' does not exist`);if(i==="options")continue;const c=i,d=t.hooks[c],h=a[c];pt.passThroughHooks.has(i)?a[c]=p=>{if(this.defaults.async)return Promise.resolve(d.call(a,p)).then(f=>h.call(a,f));const x=d.call(a,p);return h.call(a,x)}:a[c]=(...p)=>{let x=d.apply(a,p);return x===!1&&(x=h.apply(a,p)),x}}r.hooks=a}if(t.walkTokens){const a=this.defaults.walkTokens,i=t.walkTokens;r.walkTokens=function(c){let d=[];return d.push(i.call(this,c)),a&&(d=d.concat(a.call(this,c))),d}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,s){return ge.lex(e,s??this.defaults)}parser(e,s){return be.parse(e,s??this.defaults)}}Ge=new WeakSet,Kt=function(e,s){return(t,r)=>{const a={...r},i={...this.defaults,...a};this.defaults.async===!0&&a.async===!1&&(i.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),i.async=!0);const c=vt(this,Ge,an).call(this,!!i.silent,!!i.async);if(typeof t>"u"||t===null)return c(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(i.hooks&&(i.hooks.options=i),i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(t):t).then(d=>e(d,i)).then(d=>i.hooks?i.hooks.processAllTokens(d):d).then(d=>i.walkTokens?Promise.all(this.walkTokens(d,i.walkTokens)).then(()=>d):d).then(d=>s(d,i)).then(d=>i.hooks?i.hooks.postprocess(d):d).catch(c);try{i.hooks&&(t=i.hooks.preprocess(t));let d=e(t,i);i.hooks&&(d=i.hooks.processAllTokens(d)),i.walkTokens&&this.walkTokens(d,i.walkTokens);let h=s(d,i);return i.hooks&&(h=i.hooks.postprocess(h)),h}catch(d){return c(d)}}},an=function(e,s){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+te(t.message+"",!0)+"</pre>";return s?Promise.resolve(r):r}if(s)return Promise.reject(t);throw t}};const Be=new Dr;function T(l,e){return Be.parse(l,e)}T.options=T.setOptions=function(l){return Be.setOptions(l),T.defaults=Be.defaults,Xs(T.defaults),T};T.getDefaults=ns;T.defaults=We;T.use=function(...l){return Be.use(...l),T.defaults=Be.defaults,Xs(T.defaults),T};T.walkTokens=function(l,e){return Be.walkTokens(l,e)};T.parseInline=Be.parseInline;T.Parser=be;T.parser=be.parse;T.Renderer=Dt;T.TextRenderer=cs;T.Lexer=ge;T.lexer=ge.lex;T.Tokenizer=It;T.Hooks=pt;T.parse=T;T.options;T.setOptions;T.use;T.walkTokens;T.parseInline;be.parse;ge.lex;/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:on,setPrototypeOf:Ds,isFrozen:Or,getPrototypeOf:Mr,getOwnPropertyDescriptor:Pr}=Object;let{freeze:K,seal:ie,create:Vt}=Object,{apply:Qt,construct:Jt}=typeof Reflect<"u"&&Reflect;K||(K=function(e){return e});ie||(ie=function(e){return e});Qt||(Qt=function(e,s){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];return e.apply(s,r)});Jt||(Jt=function(e){for(var s=arguments.length,t=new Array(s>1?s-1:0),r=1;r<s;r++)t[r-1]=arguments[r];return new e(...t)});const At=V(Array.prototype.forEach),zr=V(Array.prototype.lastIndexOf),Os=V(Array.prototype.pop),ot=V(Array.prototype.push),$r=V(Array.prototype.splice),Ct=V(String.prototype.toLowerCase),Ft=V(String.prototype.toString),Ht=V(String.prototype.match),lt=V(String.prototype.replace),Ur=V(String.prototype.indexOf),Fr=V(String.prototype.trim),ce=V(Object.prototype.hasOwnProperty),X=V(RegExp.prototype.test),ct=Hr(TypeError);function V(l){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var s=arguments.length,t=new Array(s>1?s-1:0),r=1;r<s;r++)t[r-1]=arguments[r];return Qt(l,e,t)}}function Hr(l){return function(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++)s[t]=arguments[t];return Jt(l,s)}}function v(l,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ct;Ds&&Ds(l,null);let t=e.length;for(;t--;){let r=e[t];if(typeof r=="string"){const a=s(r);a!==r&&(Or(e)||(e[t]=a),r=a)}l[r]=!0}return l}function Br(l){for(let e=0;e<l.length;e++)ce(l,e)||(l[e]=null);return l}function Se(l){const e=Vt(null);for(const[s,t]of on(l))ce(l,s)&&(Array.isArray(t)?e[s]=Br(t):t&&typeof t=="object"&&t.constructor===Object?e[s]=Se(t):e[s]=t);return e}function dt(l,e){for(;l!==null;){const t=Pr(l,e);if(t){if(t.get)return V(t.get);if(typeof t.value=="function")return V(t.value)}l=Mr(l)}function s(){return null}return s}const Ms=K(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Bt=K(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Gt=K(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Gr=K(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Wt=K(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Wr=K(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ps=K(["#text"]),zs=K(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),qt=K(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$s=K(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),_t=K(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),qr=ie(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Zr=ie(/<%[\w\W]*|[\w\W]*%>/gm),Yr=ie(/\$\{[\w\W]*/gm),Xr=ie(/^data-[\-\w.\u00B7-\uFFFF]+$/),Kr=ie(/^aria-[\-\w]+$/),ln=ie(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Vr=ie(/^(?:\w+script|data):/i),Qr=ie(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),cn=ie(/^html$/i),Jr=ie(/^[a-z][.\w]*(-[.\w]+)+$/i);var Us=Object.freeze({__proto__:null,ARIA_ATTR:Kr,ATTR_WHITESPACE:Qr,CUSTOM_ELEMENT:Jr,DATA_ATTR:Xr,DOCTYPE_NAME:cn,ERB_EXPR:Zr,IS_ALLOWED_URI:ln,IS_SCRIPT_OR_DATA:Vr,MUSTACHE_EXPR:qr,TMPLIT_EXPR:Yr});const ut={element:1,text:3,progressingInstruction:7,comment:8,document:9},ea=function(){return typeof window>"u"?null:window},ta=function(e,s){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let t=null;const r="data-tt-policy-suffix";s&&s.hasAttribute(r)&&(t=s.getAttribute(r));const a="dompurify"+(t?"#"+t:"");try{return e.createPolicy(a,{createHTML(i){return i},createScriptURL(i){return i}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},Fs=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function dn(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ea();const e=b=>dn(b);if(e.version="3.3.0",e.removed=[],!l||!l.document||l.document.nodeType!==ut.document||!l.Element)return e.isSupported=!1,e;let{document:s}=l;const t=s,r=t.currentScript,{DocumentFragment:a,HTMLTemplateElement:i,Node:c,Element:d,NodeFilter:h,NamedNodeMap:p=l.NamedNodeMap||l.MozNamedAttrMap,HTMLFormElement:x,DOMParser:f,trustedTypes:y}=l,M=d.prototype,R=dt(M,"cloneNode"),W=dt(M,"remove"),Z=dt(M,"nextSibling"),P=dt(M,"childNodes"),I=dt(M,"parentNode");if(typeof i=="function"){const b=s.createElement("template");b.content&&b.content.ownerDocument&&(s=b.content.ownerDocument)}let L,z="";const{implementation:Te,createNodeIterator:Me,createDocumentFragment:qe,getElementsByTagName:Ze}=s,{importNode:Ye}=t;let $=Fs();e.isSupported=typeof on=="function"&&typeof I=="function"&&Te&&Te.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Ee,ERB_EXPR:ye,TMPLIT_EXPR:Ae,DATA_ATTR:k,ARIA_ATTR:Y,IS_SCRIPT_OR_DATA:ue,ATTR_WHITESPACE:se,CUSTOM_ELEMENT:he}=Us;let{IS_ALLOWED_URI:pe}=Us,D=null;const ft=v({},[...Ms,...Bt,...Gt,...Wt,...Ps]);let U=null;const Pe=v({},[...zs,...qt,...$s,..._t]);let C=Object.seal(Vt(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ze=null,st=null;const E=Object.seal(Vt(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let gt=!0,oe=!0,bt=!1,yt=!0,_e=!1,me=!0,we=!1,nt=!1,Ce=!1,Re=!1,Xe=!1,Ie=!1,rt=!0,wt=!1;const Ke="user-content-";let Ve=!0,$e=!1,Le={},De=null;const ke=v({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let kt=null;const Ue=v({},["audio","video","img","source","image","track"]);let Qe=null;const Nt=v({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),le="http://www.w3.org/1998/Math/MathML",Fe="http://www.w3.org/2000/svg",J="http://www.w3.org/1999/xhtml";let Ne=J,at=!1,Oe=null;const u=v({},[le,Fe,J],Ft);let w=v({},["mi","mo","mn","ms","mtext"]),N=v({},["annotation-xml"]);const ne=v({},["title","style","font","a","script"]);let ee=null;const hn=["application/xhtml+xml","text/html"],pn="text/html";let B=null,Je=null;const mn=s.createElement("form"),ds=function(o){return o instanceof RegExp||o instanceof Function},zt=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Je&&Je===o)){if((!o||typeof o!="object")&&(o={}),o=Se(o),ee=hn.indexOf(o.PARSER_MEDIA_TYPE)===-1?pn:o.PARSER_MEDIA_TYPE,B=ee==="application/xhtml+xml"?Ft:Ct,D=ce(o,"ALLOWED_TAGS")?v({},o.ALLOWED_TAGS,B):ft,U=ce(o,"ALLOWED_ATTR")?v({},o.ALLOWED_ATTR,B):Pe,Oe=ce(o,"ALLOWED_NAMESPACES")?v({},o.ALLOWED_NAMESPACES,Ft):u,Qe=ce(o,"ADD_URI_SAFE_ATTR")?v(Se(Nt),o.ADD_URI_SAFE_ATTR,B):Nt,kt=ce(o,"ADD_DATA_URI_TAGS")?v(Se(Ue),o.ADD_DATA_URI_TAGS,B):Ue,De=ce(o,"FORBID_CONTENTS")?v({},o.FORBID_CONTENTS,B):ke,ze=ce(o,"FORBID_TAGS")?v({},o.FORBID_TAGS,B):Se({}),st=ce(o,"FORBID_ATTR")?v({},o.FORBID_ATTR,B):Se({}),Le=ce(o,"USE_PROFILES")?o.USE_PROFILES:!1,gt=o.ALLOW_ARIA_ATTR!==!1,oe=o.ALLOW_DATA_ATTR!==!1,bt=o.ALLOW_UNKNOWN_PROTOCOLS||!1,yt=o.ALLOW_SELF_CLOSE_IN_ATTR!==!1,_e=o.SAFE_FOR_TEMPLATES||!1,me=o.SAFE_FOR_XML!==!1,we=o.WHOLE_DOCUMENT||!1,Re=o.RETURN_DOM||!1,Xe=o.RETURN_DOM_FRAGMENT||!1,Ie=o.RETURN_TRUSTED_TYPE||!1,Ce=o.FORCE_BODY||!1,rt=o.SANITIZE_DOM!==!1,wt=o.SANITIZE_NAMED_PROPS||!1,Ve=o.KEEP_CONTENT!==!1,$e=o.IN_PLACE||!1,pe=o.ALLOWED_URI_REGEXP||ln,Ne=o.NAMESPACE||J,w=o.MATHML_TEXT_INTEGRATION_POINTS||w,N=o.HTML_INTEGRATION_POINTS||N,C=o.CUSTOM_ELEMENT_HANDLING||{},o.CUSTOM_ELEMENT_HANDLING&&ds(o.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(C.tagNameCheck=o.CUSTOM_ELEMENT_HANDLING.tagNameCheck),o.CUSTOM_ELEMENT_HANDLING&&ds(o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(C.attributeNameCheck=o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),o.CUSTOM_ELEMENT_HANDLING&&typeof o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(C.allowCustomizedBuiltInElements=o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),_e&&(oe=!1),Xe&&(Re=!0),Le&&(D=v({},Ps),U=[],Le.html===!0&&(v(D,Ms),v(U,zs)),Le.svg===!0&&(v(D,Bt),v(U,qt),v(U,_t)),Le.svgFilters===!0&&(v(D,Gt),v(U,qt),v(U,_t)),Le.mathMl===!0&&(v(D,Wt),v(U,$s),v(U,_t))),o.ADD_TAGS&&(typeof o.ADD_TAGS=="function"?E.tagCheck=o.ADD_TAGS:(D===ft&&(D=Se(D)),v(D,o.ADD_TAGS,B))),o.ADD_ATTR&&(typeof o.ADD_ATTR=="function"?E.attributeCheck=o.ADD_ATTR:(U===Pe&&(U=Se(U)),v(U,o.ADD_ATTR,B))),o.ADD_URI_SAFE_ATTR&&v(Qe,o.ADD_URI_SAFE_ATTR,B),o.FORBID_CONTENTS&&(De===ke&&(De=Se(De)),v(De,o.FORBID_CONTENTS,B)),Ve&&(D["#text"]=!0),we&&v(D,["html","head","body"]),D.table&&(v(D,["tbody"]),delete ze.tbody),o.TRUSTED_TYPES_POLICY){if(typeof o.TRUSTED_TYPES_POLICY.createHTML!="function")throw ct('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof o.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ct('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');L=o.TRUSTED_TYPES_POLICY,z=L.createHTML("")}else L===void 0&&(L=ta(y,r)),L!==null&&typeof z=="string"&&(z=L.createHTML(""));K&&K(o),Je=o}},us=v({},[...Bt,...Gt,...Gr]),hs=v({},[...Wt,...Wr]),xn=function(o){let m=I(o);(!m||!m.tagName)&&(m={namespaceURI:Ne,tagName:"template"});const g=Ct(o.tagName),O=Ct(m.tagName);return Oe[o.namespaceURI]?o.namespaceURI===Fe?m.namespaceURI===J?g==="svg":m.namespaceURI===le?g==="svg"&&(O==="annotation-xml"||w[O]):!!us[g]:o.namespaceURI===le?m.namespaceURI===J?g==="math":m.namespaceURI===Fe?g==="math"&&N[O]:!!hs[g]:o.namespaceURI===J?m.namespaceURI===Fe&&!N[O]||m.namespaceURI===le&&!w[O]?!1:!hs[g]&&(ne[g]||!us[g]):!!(ee==="application/xhtml+xml"&&Oe[o.namespaceURI]):!1},xe=function(o){ot(e.removed,{element:o});try{I(o).removeChild(o)}catch{W(o)}},He=function(o,m){try{ot(e.removed,{attribute:m.getAttributeNode(o),from:m})}catch{ot(e.removed,{attribute:null,from:m})}if(m.removeAttribute(o),o==="is")if(Re||Xe)try{xe(m)}catch{}else try{m.setAttribute(o,"")}catch{}},ps=function(o){let m=null,g=null;if(Ce)o="<remove></remove>"+o;else{const F=Ht(o,/^[\r\n\t ]+/);g=F&&F[0]}ee==="application/xhtml+xml"&&Ne===J&&(o='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+o+"</body></html>");const O=L?L.createHTML(o):o;if(Ne===J)try{m=new f().parseFromString(O,ee)}catch{}if(!m||!m.documentElement){m=Te.createDocument(Ne,"template",null);try{m.documentElement.innerHTML=at?z:O}catch{}}const q=m.body||m.documentElement;return o&&g&&q.insertBefore(s.createTextNode(g),q.childNodes[0]||null),Ne===J?Ze.call(m,we?"html":"body")[0]:we?m.documentElement:q},ms=function(o){return Me.call(o.ownerDocument||o,o,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},$t=function(o){return o instanceof x&&(typeof o.nodeName!="string"||typeof o.textContent!="string"||typeof o.removeChild!="function"||!(o.attributes instanceof p)||typeof o.removeAttribute!="function"||typeof o.setAttribute!="function"||typeof o.namespaceURI!="string"||typeof o.insertBefore!="function"||typeof o.hasChildNodes!="function")},xs=function(o){return typeof c=="function"&&o instanceof c};function ve(b,o,m){At(b,g=>{g.call(e,o,m,Je)})}const fs=function(o){let m=null;if(ve($.beforeSanitizeElements,o,null),$t(o))return xe(o),!0;const g=B(o.nodeName);if(ve($.uponSanitizeElement,o,{tagName:g,allowedTags:D}),me&&o.hasChildNodes()&&!xs(o.firstElementChild)&&X(/<[/\w!]/g,o.innerHTML)&&X(/<[/\w!]/g,o.textContent)||o.nodeType===ut.progressingInstruction||me&&o.nodeType===ut.comment&&X(/<[/\w]/g,o.data))return xe(o),!0;if(!(E.tagCheck instanceof Function&&E.tagCheck(g))&&(!D[g]||ze[g])){if(!ze[g]&&bs(g)&&(C.tagNameCheck instanceof RegExp&&X(C.tagNameCheck,g)||C.tagNameCheck instanceof Function&&C.tagNameCheck(g)))return!1;if(Ve&&!De[g]){const O=I(o)||o.parentNode,q=P(o)||o.childNodes;if(q&&O){const F=q.length;for(let Q=F-1;Q>=0;--Q){const je=R(q[Q],!0);je.__removalCount=(o.__removalCount||0)+1,O.insertBefore(je,Z(o))}}}return xe(o),!0}return o instanceof d&&!xn(o)||(g==="noscript"||g==="noembed"||g==="noframes")&&X(/<\/no(script|embed|frames)/i,o.innerHTML)?(xe(o),!0):(_e&&o.nodeType===ut.text&&(m=o.textContent,At([Ee,ye,Ae],O=>{m=lt(m,O," ")}),o.textContent!==m&&(ot(e.removed,{element:o.cloneNode()}),o.textContent=m)),ve($.afterSanitizeElements,o,null),!1)},gs=function(o,m,g){if(rt&&(m==="id"||m==="name")&&(g in s||g in mn))return!1;if(!(oe&&!st[m]&&X(k,m))){if(!(gt&&X(Y,m))){if(!(E.attributeCheck instanceof Function&&E.attributeCheck(m,o))){if(!U[m]||st[m]){if(!(bs(o)&&(C.tagNameCheck instanceof RegExp&&X(C.tagNameCheck,o)||C.tagNameCheck instanceof Function&&C.tagNameCheck(o))&&(C.attributeNameCheck instanceof RegExp&&X(C.attributeNameCheck,m)||C.attributeNameCheck instanceof Function&&C.attributeNameCheck(m,o))||m==="is"&&C.allowCustomizedBuiltInElements&&(C.tagNameCheck instanceof RegExp&&X(C.tagNameCheck,g)||C.tagNameCheck instanceof Function&&C.tagNameCheck(g))))return!1}else if(!Qe[m]){if(!X(pe,lt(g,se,""))){if(!((m==="src"||m==="xlink:href"||m==="href")&&o!=="script"&&Ur(g,"data:")===0&&kt[o])){if(!(bt&&!X(ue,lt(g,se,"")))){if(g)return!1}}}}}}}return!0},bs=function(o){return o!=="annotation-xml"&&Ht(o,he)},ys=function(o){ve($.beforeSanitizeAttributes,o,null);const{attributes:m}=o;if(!m||$t(o))return;const g={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U,forceKeepAttr:void 0};let O=m.length;for(;O--;){const q=m[O],{name:F,namespaceURI:Q,value:je}=q,et=B(F),Ut=je;let G=F==="value"?Ut:Fr(Ut);if(g.attrName=et,g.attrValue=G,g.keepAttr=!0,g.forceKeepAttr=void 0,ve($.uponSanitizeAttribute,o,g),G=g.attrValue,wt&&(et==="id"||et==="name")&&(He(F,o),G=Ke+G),me&&X(/((--!?|])>)|<\/(style|title|textarea)/i,G)){He(F,o);continue}if(et==="attributename"&&Ht(G,"href")){He(F,o);continue}if(g.forceKeepAttr)continue;if(!g.keepAttr){He(F,o);continue}if(!yt&&X(/\/>/i,G)){He(F,o);continue}_e&&At([Ee,ye,Ae],ks=>{G=lt(G,ks," ")});const ws=B(o.nodeName);if(!gs(ws,et,G)){He(F,o);continue}if(L&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!Q)switch(y.getAttributeType(ws,et)){case"TrustedHTML":{G=L.createHTML(G);break}case"TrustedScriptURL":{G=L.createScriptURL(G);break}}if(G!==Ut)try{Q?o.setAttributeNS(Q,F,G):o.setAttribute(F,G),$t(o)?xe(o):Os(e.removed)}catch{He(F,o)}}ve($.afterSanitizeAttributes,o,null)},fn=function b(o){let m=null;const g=ms(o);for(ve($.beforeSanitizeShadowDOM,o,null);m=g.nextNode();)ve($.uponSanitizeShadowNode,m,null),fs(m),ys(m),m.content instanceof a&&b(m.content);ve($.afterSanitizeShadowDOM,o,null)};return e.sanitize=function(b){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=null,g=null,O=null,q=null;if(at=!b,at&&(b="<!-->"),typeof b!="string"&&!xs(b))if(typeof b.toString=="function"){if(b=b.toString(),typeof b!="string")throw ct("dirty is not a string, aborting")}else throw ct("toString is not a function");if(!e.isSupported)return b;if(nt||zt(o),e.removed=[],typeof b=="string"&&($e=!1),$e){if(b.nodeName){const je=B(b.nodeName);if(!D[je]||ze[je])throw ct("root node is forbidden and cannot be sanitized in-place")}}else if(b instanceof c)m=ps("<!---->"),g=m.ownerDocument.importNode(b,!0),g.nodeType===ut.element&&g.nodeName==="BODY"||g.nodeName==="HTML"?m=g:m.appendChild(g);else{if(!Re&&!_e&&!we&&b.indexOf("<")===-1)return L&&Ie?L.createHTML(b):b;if(m=ps(b),!m)return Re?null:Ie?z:""}m&&Ce&&xe(m.firstChild);const F=ms($e?b:m);for(;O=F.nextNode();)fs(O),ys(O),O.content instanceof a&&fn(O.content);if($e)return b;if(Re){if(Xe)for(q=qe.call(m.ownerDocument);m.firstChild;)q.appendChild(m.firstChild);else q=m;return(U.shadowroot||U.shadowrootmode)&&(q=Ye.call(t,q,!0)),q}let Q=we?m.outerHTML:m.innerHTML;return we&&D["!doctype"]&&m.ownerDocument&&m.ownerDocument.doctype&&m.ownerDocument.doctype.name&&X(cn,m.ownerDocument.doctype.name)&&(Q="<!DOCTYPE "+m.ownerDocument.doctype.name+`>
`+Q),_e&&At([Ee,ye,Ae],je=>{Q=lt(Q,je," ")}),L&&Ie?L.createHTML(Q):Q},e.setConfig=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};zt(b),nt=!0},e.clearConfig=function(){Je=null,nt=!1},e.isValidAttribute=function(b,o,m){Je||zt({});const g=B(b),O=B(o);return gs(g,O,m)},e.addHook=function(b,o){typeof o=="function"&&ot($[b],o)},e.removeHook=function(b,o){if(o!==void 0){const m=zr($[b],o);return m===-1?void 0:$r($[b],m,1)[0]}return Os($[b])},e.removeHooks=function(b){$[b]=[]},e.removeAllHooks=function(){$=Fs()},e}var sa=dn();T.setOptions({gfm:!0,breaks:!0});const na=l=>l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ra=`# 見出しレベル1

## 見出しレベル2

### 見出しレベル3

#### 見出しレベル4

**太字テキスト** と *斜体テキスト*、そして \`インラインコード\`。

> ブロック引用: 雨上がりの匂いが、彼女の記憶を呼び起こした。

- 箇条書き1
- 箇条書き2
  - ネスト1
  - ネスト2

1. 番号付きリスト
2. 二行目

[リンク例](https://example.com) と ![画像例](https://placehold.co/100x60)。

| 列A | 列B | 列C |
| --- | --- | --- |
| 太字 | *斜体* | \`コード\` |

\`\`\`ts
function greet(name: string) {
  console.log(\`こんにちは、\${name}さん\`)
}
\`\`\`

---
`,aa=l=>{const e=T.parse(l,{async:!1});return sa.sanitize(e)},ia=l=>`<mark class="bg-yellow-100 text-gray-800 font-semibold px-1 rounded-sm" data-dictionary-term="${l}">$1</mark>`,oa=(l,e)=>{if(!l||!e.length)return l;const s=e.map(d=>{var h;return(h=d.term)==null?void 0:h.trim()}).filter(d=>!!d);if(s.length===0)return l;const t=d=>s.reduce((h,p)=>{const x=new RegExp(`(${na(p)})`,"gi");return h.replace(x,ia(p))},d);if(typeof window>"u"||typeof window.DOMParser>"u")return t(l);const a=new window.DOMParser().parseFromString(l,"text/html"),i=a.createTreeWalker(a.body,NodeFilter.SHOW_TEXT),c=[];for(;i.nextNode();)c.push(i.currentNode);return c.forEach(d=>{const h=d.nodeValue??"",p=t(h);if(h!==p){const x=a.createElement("span");x.innerHTML=p,d.replaceWith(...Array.from(x.childNodes))}}),a.body.innerHTML},la=/^(#+)\s+(.*)$/,un=l=>{const e=l.split(`
`),s=[];return e.forEach((t,r)=>{const a=t.trim().match(la);a&&s.push({id:`section-${r}`,level:a[1].length,text:a[2],startLine:r,endLine:e.length})}),s.forEach((t,r)=>{const a=s.slice(r+1).find(i=>i.level<=t.level);t.endLine=a?a.startLine:e.length}),s.length===0&&l.trim().length>0&&s.push({id:"section-0",level:1,text:l.trim().split(`
`).slice(0,3).join(" "),startLine:0,endLine:e.length}),s},ca=(l,e,s)=>{const t=l.split(`
`),r=un(l),a=r.findIndex(x=>x.id===e);if(a===-1)return l;let i=-1;if(s==="up"){for(let x=a-1;x>=0;x-=1)if(r[x].level===r[a].level){i=x;break}}else for(let x=a+1;x<r.length;x+=1)if(r[x].level===r[a].level){i=x;break}if(i===-1)return l;const c=r[a],d=r[i],h=c.endLine-c.startLine,p=t.slice(c.startLine,c.endLine);if(t.splice(c.startLine,h),s==="up")t.splice(d.startLine,0,...p);else{const x=d.endLine-h;t.splice(x,0,...p)}return t.join(`
`)},da=["outline","plain","preview","markdown"],ua=["edit","split","preview"],ha=`
### 一章　冷たい朝
窓の外では、灰色の空が静かに澱んでいる。  
雨粒がガラスを伝い、ひとつひとつの呼吸のように流れていく。  
目を覚ましても、世界はまだ眠っているようだった。

### 二章　傘の下の世界
通りには、人の影がぽつぽつと揺れている。  
傘の布地を叩く音が、唯一のリズム。  
すれ違う誰かの温度が、雨に溶けて消えていった。

### 三章　湯気の向こう
喫茶店の扉を開けると、温かな香りが迎えてくれる。  
コーヒーの湯気が曇った眼鏡を曇らせ、世界を少し柔らかくした。
`,pa=`# 雨の日の幸

## 一章　冷たい朝
窓の外では、灰色の空が静かに澱んでいる。
雨粒がガラスを伝い、ひとつひとつの呼吸のように流れていく。
目を覚ましても、世界はまだ眠っているようだった。

## 二章　傘の下の世界
通りには、人の影がぽつぽつと揺れている。
傘の布地を叩く音が、唯一のリズム。
すれ違う誰かの温度が、雨に溶けて消えていった。

## 三章　湯気の向こう
喫茶店の扉を開けると、温かな香りが迎えてくれる。
コーヒーの湯気が曇った眼鏡を曇らせ、世界を少し柔らかくした。
`,ma=()=>{const{user:l,signOut:e}=Mt(),s=es(),[t,r]=S.useState([]),[a,i]=S.useState(!0),[c,d]=S.useState(null),[h,p]=S.useState("plain"),[x,f]=S.useState("edit"),y=S.useRef("edit"),[M,R]=S.useState(!1),[W,Z]=S.useState(!1),[P,I]=S.useState(pa),[L,z]=S.useState(""),[Te,Me]=S.useState(""),[qe,Ze]=S.useState(!1),[Ye,$]=S.useState(!1),[Ee,ye]=S.useState(""),[Ae,k]=S.useState(!1),[Y,ue]=S.useState(!1),[se,he]=S.useState([]),[pe,D]=S.useState(null),[ft,U]=S.useState(!1),[Pe,C]=S.useState([{id:"summary",title:"あらすじ",content:""},{id:"note",title:"Note",content:""},{id:"vocabulary",title:"単語帳",content:""},{id:"memo",title:"メモ",content:""}]),[ze,st]=S.useState(new Set);S.useEffect(()=>{l||s("/login")},[l,s]),S.useEffect(()=>{l&&oe()},[l]),S.useEffect(()=>{t.length>0&&!c&&d(t[0].id)},[t,c]);const E=t.find(u=>u.id===c)||null;S.useEffect(()=>{E?(I(E.content),z(E.title),he(E.dictionaryEntries??[])):(I(""),z(""),he([]))},[E]),S.useEffect(()=>{h==="preview"&&x!=="preview"?f("preview"):h==="markdown"&&x!==y.current&&f(y.current)},[h,x]);const gt=u=>{z(u),E&&l&&(re.updateScenario(E.id,{title:u}),oe())},oe=async()=>{try{if(l){const u=re.getUserScenarios(l.uid);r(u)}}catch(u){console.error("Error loading scenarios:",u)}finally{i(!1)}},bt=async()=>{try{await e(),s("/login")}catch(u){console.error("Sign out error:",u)}},yt=()=>{if(!l)return;const u=re.createScenario({title:"新しいプロジェクト",content:"ここに新しいシナリオを作成してください。",tags:[],isPublic:!1,authorId:l.uid});oe(),d(u)},_e=u=>{console.log("Settings saved:",u)},me=u=>{I(u),E&&l&&re.updateScenario(E.id,{content:u})},we=u=>{if(h==="markdown"){y.current=u,f(u);return}if(h==="preview"){u==="preview"?f("preview"):(y.current=u,p("markdown"),f(u));return}p("markdown"),y.current=u,f(u)},nt=()=>{me(ra),p("markdown")},Ce=()=>{Z(!0)},Re=u=>{Me(u)},Xe=async u=>{Ze(!0);try{await new Promise(N=>setTimeout(N,1500));const w=`【生成されたテキスト】

${u}に基づいて生成されたテキストがここに表示されます。

実際の実装では、AI API（ChatGPTまたはClaude）から取得したテキストが表示されます。`;Me(w)}catch(w){console.error("Text generation error:",w),Me("テキストの生成中にエラーが発生しました。")}finally{Ze(!1)}},Ie=()=>{if($(!0),E){const u=E.tags||[],w=u.length>0?u.map(N=>`# ${N}`).join(`

`):"# main";ye(w||"# main")}else ye("# main")},rt=()=>{$(!1)},wt=()=>{const u=prompt("タグ名を入力してください:");if(u&&E){const w=E.tags||[];if(!w.includes(u)){re.updateScenario(E.id,{tags:[...w,u]}),oe();const ne=[...w,u].map(ee=>`# ${ee}`).join(`

`);ye(ne)}}},Ke=()=>{Ae||k(!0),D(null),ue(!0)},Ve=({term:u,description:w})=>{if(!E)return;const N=re.addDictionaryEntry(E.id,{term:u,description:w});N&&(he(ne=>[...ne,N]),k(!0),oe(),D(null))},$e=u=>{E&&(re.removeDictionaryEntry(E.id,u),he(w=>w.filter(N=>N.id!==u)),oe())},Le=({term:u,description:w})=>{if(E){if(pe){const N=re.updateDictionaryEntry(E.id,pe.id,{term:u,description:w});N&&(he(ne=>ne.map(ee=>ee.id===N.id?N:ee)),D(null),k(!0),oe());return}Ve({term:u,description:w})}},De=u=>{D(u),ue(!0)},ke=()=>{k(!1)},kt=()=>{alert("資料の検索機能は今後実装予定です")},Ue=()=>{U(!0)},Qe=(u,w)=>{C(Pe.map(N=>N.id===u?{...N,title:w}:N))},Nt=u=>{C(Pe.filter(w=>w.id!==u))},le=S.useMemo(()=>un(P),[P]),Fe=S.useMemo(()=>aa(P||ha),[P]),J=S.useMemo(()=>oa(Fe,se),[Fe,se]),Ne=S.useMemo(()=>{const u=new Map,w=new Map;return le.forEach(N=>{const ne=w.get(N.level)??[];ne.push(N),w.set(N.level,ne)}),w.forEach(N=>{N.forEach((ne,ee)=>{u.set(ne.id,{canMoveUp:ee>0,canMoveDown:ee<N.length-1})})}),u},[le]),at=u=>{const w=new Set(ze);w.has(u)?w.delete(u):w.add(u),st(w)},Oe=(u,w)=>{const N=ca(P,u,w);N!==P&&me(N)};return a?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 text-gray-700",children:n.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-gray-400"})}):l?n.jsxs("div",{className:"min-h-screen bg-gray-100 text-gray-900",children:[n.jsxs("div",{className:"w-full max-w-none mx-auto px-4 sm:px-6 lg:px-12 xl:px-16 py-10",children:[n.jsx("div",{className:"mb-8",children:n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{className:"flex-1 max-w-md",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロジェクトの名前"}),n.jsx("input",{type:"text",value:L,onChange:u=>gt(u.target.value),placeholder:"プロジェクト名を入力",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs(H,{variant:"outline",className:"px-6",onClick:()=>R(!0),children:[n.jsx(Cn,{className:"h-4 w-4 mr-2"}),"設定"]}),n.jsxs(H,{variant:"outline",className:"px-6",onClick:bt,children:[n.jsx(Rn,{className:"h-4 w-4 mr-2"}),"ログアウト"]})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-[clamp(220px,18vw,280px)_minmax(0,1fr)_clamp(240px,21vw,360px)]",children:[n.jsxs("aside",{className:"border border-gray-300 bg-white rounded-lg p-4 flex flex-col h-[794px]",children:[n.jsx("h2",{className:"text-sm font-semibold text-gray-700 mb-4",children:"プロジェクト一覧"}),n.jsx("div",{className:"space-y-2 flex-1 overflow-auto pr-1",children:t.length===0?n.jsx("p",{className:"text-sm text-gray-500",children:"まだプロジェクトがありません。"}):t.map(u=>n.jsx("button",{onClick:()=>d(u.id),className:`w-full text-left px-3 py-2 rounded-md border ${c===u.id?"border-gray-900 bg-gray-900 text-white":"border-gray-300 bg-white hover:bg-gray-50"} transition`,children:n.jsx("p",{className:"text-sm font-medium truncate",children:u.title})},u.id))}),n.jsxs(H,{variant:"outline",onClick:yt,className:"mt-4 w-full justify-center",children:[n.jsx(Hs,{className:"h-4 w-4 mr-2"}),"新規作成"]})]}),n.jsxs("section",{className:"border border-gray-300 bg-white rounded-lg p-6 h-[794px] flex flex-col",children:[n.jsxs("div",{className:"flex items-center flex-wrap gap-3 mb-6",children:[n.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"ViewMode"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:da.map(u=>n.jsx("button",{onClick:()=>p(u),className:`px-4 py-1.5 rounded-md border text-sm capitalize ${h===u?u==="plain"||u==="outline"||u==="preview"||u==="markdown"?"border-green-500 bg-green-500 text-white":"border-gray-900 bg-gray-900 text-white":"border-gray-300 bg-white hover:bg-gray-50"} transition`,children:u},u))}),(h==="markdown"||h==="preview")&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"表示"}),n.jsx("div",{className:"inline-flex rounded-md border border-gray-200 overflow-hidden",children:ua.map(u=>n.jsx("button",{type:"button",onClick:()=>we(u),className:`px-3 py-1 text-xs font-medium capitalize ${x===u?"bg-gray-900 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:u==="edit"?"編集":u==="split"?"分割":"プレビュー"},u))})]}),n.jsx("button",{type:"button",onClick:nt,className:"text-xs font-semibold border border-dashed border-gray-300 rounded-md px-3 py-1 text-gray-600 hover:bg-gray-100 transition",children:"Markdownテスト挿入"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[220px_minmax(0,1fr)] gap-6 flex-1",children:[(h==="outline"||h==="plain"||h==="preview"||h==="markdown"||h===null)&&n.jsxs("div",{className:"border border-gray-200 rounded-md p-4 bg-gray-50 overflow-auto",style:{maxHeight:"calc(794px - 120px)"},children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Outline"}),n.jsx("div",{className:"space-y-1 text-sm text-gray-600",children:le.length>0?le.map(u=>{const w=Ne.get(u.id)??{canMoveUp:!1,canMoveDown:!1};return n.jsxs("div",{className:"flex items-center gap-1 group",children:[n.jsx("button",{type:"button",className:`flex-1 text-left truncate hover:bg-gray-100 px-2 py-1 rounded transition ${u.level<=1?"pl-0":u.level===2?"pl-4":"pl-8"}`,onClick:()=>at(u.id),children:u.text}),n.jsxs("div",{className:"flex flex-col gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[n.jsx("button",{type:"button",onClick:()=>Oe(u.id,"up"),disabled:!w.canMoveUp,className:`p-1 rounded border text-xs ${w.canMoveUp?"hover:bg-gray-100 text-gray-600":"text-gray-300 cursor-not-allowed"}`,"aria-label":"セクションを上に移動",children:n.jsx(js,{className:"h-3 w-3"})}),n.jsx("button",{type:"button",onClick:()=>Oe(u.id,"down"),disabled:!w.canMoveDown,className:`p-1 rounded border text-xs ${w.canMoveDown?"hover:bg-gray-100 text-gray-600":"text-gray-300 cursor-not-allowed"}`,"aria-label":"セクションを下に移動",children:n.jsx(Ss,{className:"h-3 w-3"})})]})]},u.id)}):n.jsx("p",{className:"text-gray-400",children:"アウトラインはまだありません。"})})]}),n.jsx("div",{className:`border border-gray-200 rounded-md p-4 overflow-auto bg-white ${h==="outline"||h==="plain"||h==="preview"||h==="markdown"||h===null?"":"md:col-span-2"}`,style:{maxHeight:"calc(794px - 120px)"},children:E?h===null?n.jsxs("div",{className:"relative h-full min-h-[400px] flex items-center justify-center bg-white",children:[n.jsx("div",{className:"absolute left-6 bottom-16 w-2/3 border-t border-dashed border-gray-300 rotate-[-12deg]"}),n.jsx("span",{className:"text-lg font-semibold text-gray-600 bg-white px-3 py-1 shadow-sm rounded",children:"Main Editor"})]}):h==="outline"?n.jsxs("div",{className:"h-full min-h-[400px] flex flex-col",children:[le.length>0?n.jsx("div",{className:"flex-1 space-y-3",children:le.map((u,w)=>{const N=Ne.get(u.id)??{canMoveUp:!1,canMoveDown:!1};return n.jsxs("div",{className:"flex flex-col border border-gray-100 rounded-lg p-3 hover:border-gray-300 transition-colors",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("span",{className:"text-sm font-semibold text-gray-500",children:[w+1,"章"]}),n.jsx("span",{className:"font-medium text-gray-800",children:u.text})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{type:"button",onClick:()=>Oe(u.id,"up"),disabled:!N.canMoveUp,className:`p-1 rounded border ${N.canMoveUp?"hover:bg-gray-100 text-gray-600":"text-gray-300 cursor-not-allowed opacity-60"}`,"aria-label":"上に移動",children:n.jsx(js,{className:"h-4 w-4"})}),n.jsx("button",{type:"button",onClick:()=>Oe(u.id,"down"),disabled:!N.canMoveDown,className:`p-1 rounded border ${N.canMoveDown?"hover:bg-gray-100 text-gray-600":"text-gray-300 cursor-not-allowed opacity-60"}`,"aria-label":"下に移動",children:n.jsx(Ss,{className:"h-4 w-4"})})]})]}),n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["レベル: ",u.level," / 開始行 ",u.startLine+1]})]},`outline-main-${u.id}-${w}`)})}):n.jsx("div",{className:"flex-1 flex items-center justify-center text-sm text-gray-400",children:"アウトラインはまだありません。"}),n.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 text-xs text-gray-500 space-y-1",children:[n.jsx("p",{children:"いわゆるアウトラインエディタモード"}),n.jsx("p",{children:"本文は折りたたまれている"}),n.jsx("p",{children:"header要素をドラッグ・アンド・ドロップできる"})]})]}):h==="plain"?n.jsxs("div",{className:"h-full flex flex-col min-h-[400px]",children:[n.jsx("textarea",{value:P,onChange:u=>me(u.target.value),className:"w-full flex-1 text-sm leading-relaxed text-gray-700 resize-none border-none outline-none font-sans",placeholder:"ここにプレーンテキストで内容を入力してください...",style:{fontFamily:"inherit",minHeight:"320px"}}),n.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 text-xs text-gray-500 space-y-1",children:[n.jsx("p",{children:"プレーンテキストモード"}),n.jsx("p",{children:"markdownのレンダリングが使用されない"}),n.jsx("p",{children:"読み・書き下ろしのためのモード"})]})]}):h==="preview"?n.jsxs("div",{className:"h-full min-h-[400px]",children:[n.jsx("div",{className:"text-sm leading-relaxed text-gray-700 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:J}}),n.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 text-xs text-gray-500 space-y-1",children:[n.jsx("p",{children:"このツールでは表現できないが、強調表示やリストなど"}),n.jsx("p",{children:"markdownのレンダリング表示モード"}),n.jsx("p",{children:"リンクや辞書などをハイライト表示"})]})]}):h==="markdown"?n.jsxs("div",{className:"h-full flex flex-col min-h-[400px]",children:[x==="split"?n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 flex-1",children:[n.jsx("textarea",{value:P,onChange:u=>me(u.target.value),className:"w-full h-full text-sm leading-relaxed text-gray-700 font-mono resize-none border border-gray-200 rounded-lg p-3",placeholder:"ここにMarkdown形式で内容を入力してください..."}),n.jsx("div",{className:"border border-gray-200 rounded-lg p-3 overflow-auto",children:n.jsx("div",{className:"text-sm leading-relaxed text-gray-700 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:J}})})]}):x==="preview"?n.jsx("div",{className:"flex-1 border border-gray-200 rounded-lg p-4 overflow-auto",children:n.jsx("div",{className:"text-sm leading-relaxed text-gray-700 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:J}})}):n.jsx("textarea",{value:P,onChange:u=>me(u.target.value),className:"w-full flex-1 text-sm leading-relaxed text-gray-700 font-mono resize-none border-none outline-none",placeholder:"ここにMarkdown形式で内容を入力してください...",style:{minHeight:"400px"}}),n.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 text-xs text-center text-gray-500",children:n.jsx("p",{children:"markdown 編集モード"})})]}):n.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap text-gray-700 font-mono",children:P}):n.jsx("p",{className:"text-sm text-gray-500",children:"プロジェクトを選択すると内容が表示されます。"})})]})]}),ft?n.jsxs("aside",{className:"border border-gray-300 bg-white rounded-lg p-4 flex flex-col h-[794px] space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-2",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"校正モード"}),n.jsx("button",{onClick:()=>U(!1),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"校正モードを閉じる",children:n.jsx(de,{className:"h-4 w-4"})})]}),Pe.map(u=>n.jsxs("div",{className:"border border-gray-300 rounded-md bg-white",children:[n.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200",children:[n.jsx("input",{type:"text",value:u.title,onChange:w=>Qe(u.id,w.target.value),className:"text-sm font-semibold text-gray-700 bg-transparent border-none outline-none focus:bg-gray-50 px-1 rounded",onBlur:w=>{w.target.value.trim()||Qe(u.id,"新しいパネル")}}),n.jsx("button",{onClick:()=>Nt(u.id),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"閉じる",children:n.jsx(de,{className:"h-4 w-4"})})]}),n.jsx("div",{className:"px-3 py-2 min-h-[80px]",children:n.jsx("textarea",{value:u.content,onChange:w=>{C(Pe.map(N=>N.id===u.id?{...N,content:w.target.value}:N))},className:"w-full text-sm text-gray-700 border-none outline-none resize-none",placeholder:"内容を入力...",rows:3})})]},u.id)),n.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-auto",children:[n.jsx("button",{onClick:Ce,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition",children:"＋ 文章の追加"}),n.jsx("button",{onClick:Ke,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition",children:"＋ 辞書の追加"}),n.jsx("button",{onClick:Ie,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition",children:"＋ タグの追加"}),n.jsxs("button",{onClick:Ue,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition flex items-center justify-between",children:[n.jsx("span",{children:"範囲を校正"}),n.jsx(jt,{className:"h-4 w-4"})]})]})]}):Ae?n.jsxs("aside",{className:"border border-gray-300 bg-white rounded-lg p-4 flex flex-col h-[794px] space-y-3",children:[n.jsxs("div",{className:"border border-gray-300 rounded-md bg-white",children:[n.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"あらすじ"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"最小化",children:n.jsx(St,{className:"h-4 w-4"})}),n.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"閉じる",children:n.jsx(de,{className:"h-4 w-4"})})]})]}),n.jsx("div",{className:"px-3 py-2 min-h-[80px]",children:n.jsx("textarea",{className:"w-full text-sm text-gray-700 border-none outline-none resize-none",placeholder:"あらすじを入力...",rows:3})})]}),n.jsxs("div",{className:"border border-gray-300 rounded-md bg-white",children:[n.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Note"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"最小化",children:n.jsx(St,{className:"h-4 w-4"})}),n.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"閉じる",children:n.jsx(de,{className:"h-4 w-4"})})]})]}),n.jsx("div",{className:"px-3 py-2 min-h-[80px]",children:n.jsx("textarea",{className:"w-full text-sm text-gray-700 border-none outline-none resize-none",placeholder:"ノートを入力...",rows:3})})]}),n.jsxs("div",{className:"border border-gray-300 rounded-md bg-white",children:[n.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"タグ"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"最小化",children:n.jsx(St,{className:"h-4 w-4"})}),n.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"閉じる",children:n.jsx(de,{className:"h-4 w-4"})})]})]}),n.jsxs("div",{className:"px-3 py-2 flex items-center gap-2",children:[n.jsx("span",{className:"text-sm text-gray-700",children:"タグ"}),n.jsx("button",{className:"px-3 py-1 bg-yellow-200 hover:bg-yellow-300 rounded-md text-sm text-gray-700 transition-colors",children:"Main"}),n.jsx("button",{className:"px-3 py-1 border border-gray-300 hover:bg-gray-50 rounded-md text-sm text-gray-700 transition-colors",children:"+説明を追加"})]})]}),se.map(u=>n.jsxs("div",{className:"border border-gray-300 rounded-md bg-white",children:[n.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:u.term}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>De(u),className:"text-gray-400 hover:text-gray-600 transition-colors text-xs","aria-label":"辞書エントリを編集",children:"編集"}),n.jsx("button",{onClick:()=>$e(u.id),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"辞書エントリを削除",children:n.jsx(de,{className:"h-4 w-4"})})]})]}),n.jsxs("div",{className:"px-3 py-2",children:[n.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:u.description}),n.jsxs("p",{className:"text-[11px] text-gray-400 mt-2",children:["登録日: ",u.createdAt?new Date(u.createdAt).toLocaleDateString():"-"]})]})]},u.id)),n.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-auto",children:[n.jsx("button",{onClick:Ce,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition",children:"＋ 文章の追加"}),n.jsx("button",{onClick:Ke,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition",children:"＋ 辞書の追加"}),n.jsx("button",{onClick:Ie,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition",children:"＋ タグの追加"}),n.jsxs("button",{onClick:Ue,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition flex items-center justify-between",children:[n.jsx("span",{children:"範囲を校正"}),n.jsx(jt,{className:"h-4 w-4"})]})]})]}):Ye?n.jsxs("aside",{className:"border border-gray-300 bg-white rounded-lg p-4 flex flex-col min-h-[794px]",children:[n.jsxs("div",{className:"border border-gray-300 rounded-md bg-white mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"タグ"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:rt,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"最小化",children:n.jsx(St,{className:"h-4 w-4"})}),n.jsx("button",{onClick:rt,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"閉じる",children:n.jsx(de,{className:"h-4 w-4"})})]})]}),n.jsx("div",{className:"px-3 py-2",children:n.jsx("p",{className:"text-sm text-gray-700",children:"main"})})]}),n.jsxs("div",{className:"flex-1 border border-gray-200 rounded-md bg-white p-4 mb-4 overflow-auto",children:[n.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"追加されたファイルのプレビューが出る"}),n.jsx("div",{className:"min-h-[200px]",children:Ee?n.jsx("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap font-mono",children:Ee}):n.jsx("p",{className:"text-sm text-gray-400",children:"プレビューがここに表示されます"})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsx("button",{onClick:Ce,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition",children:"＋ 文章の追加"}),n.jsx("button",{onClick:Ke,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition",children:"＋ 辞書の追加"}),n.jsx("button",{onClick:wt,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition",children:"＋ タグの追加"}),n.jsxs("button",{onClick:Ue,className:"border border-gray-300 rounded-md px-3 py-2 text-sm text-left hover:bg-gray-50 transition flex items-center justify-between",children:[n.jsx("span",{children:"範囲を校正"}),n.jsx(jt,{className:"h-4 w-4"})]})]})]}):n.jsxs("aside",{className:"border border-gray-300 bg-white rounded-lg p-4 flex flex-col space-y-3 h-[794px]",children:[n.jsxs("div",{className:"border border-gray-300 rounded-md p-4 bg-white mb-4",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"生成テキスト"}),n.jsx("div",{className:"min-h-[120px] max-h-[200px] overflow-auto",children:qe?n.jsxs("div",{className:"flex items-center justify-center h-full",children:[n.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-400"}),n.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"生成中..."})]}):Te?n.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:Te}):n.jsx("p",{className:"text-sm text-gray-400",children:"生成されたテキストがここに表示されることになります"})})]}),n.jsx("button",{onClick:Ce,className:"w-full border border-gray-300 rounded-md px-4 py-3 text-sm text-left hover:bg-gray-50 transition",children:"＋ 文章の追加"}),n.jsx("button",{onClick:Ie,className:"w-full border border-gray-300 rounded-md px-4 py-3 text-sm text-left hover:bg-gray-50 transition",children:"＋ タグの追加"}),n.jsx("button",{onClick:Ke,className:"w-full border border-gray-300 rounded-md px-4 py-3 text-sm text-left hover:bg-gray-50 transition",children:"＋ 辞書の追加"}),n.jsxs("button",{onClick:kt,className:"w-full border border-gray-300 rounded-md px-4 py-3 text-sm text-left hover:bg-gray-50 transition flex items-center",children:[n.jsx(In,{className:"h-4 w-4 mr-2"})," 資料の検索"]}),n.jsxs("button",{onClick:Ue,className:"w-full border border-gray-300 rounded-md px-4 py-3 text-sm text-left hover:bg-gray-50 transition flex items-center justify-between",children:[n.jsx("span",{children:"範囲を校正"}),n.jsx(jt,{className:"h-4 w-4"})]})]})]})]}),n.jsx(Vn,{isOpen:M,onClose:()=>R(!1),onSave:_e}),n.jsx(Qn,{isOpen:W,onClose:()=>Z(!1),onSave:Re,onNext:Xe}),n.jsx(Jn,{isOpen:Y,onClose:()=>{ue(!1),D(null)},onSave:Le,onNext:pe?void 0:Ve,mode:pe?"edit":"create",initialEntry:pe?{term:pe.term,description:pe.description}:void 0})]}):null},xa=({variant:l="info",title:e,message:s,onClose:t,className:r=""})=>{const i={success:{bg:"bg-green-50",border:"border-green-200",text:"text-green-800",icon:Mn,iconColor:"text-green-600"},error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",icon:On,iconColor:"text-red-600"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",icon:Dn,iconColor:"text-yellow-600"},info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-800",icon:Ln,iconColor:"text-blue-600"}}[l],c=i.icon;return n.jsx("div",{className:`${i.bg} ${i.border} border rounded-lg p-4 ${r}`,role:"alert",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(c,{className:`${i.iconColor} h-5 w-5 mt-0.5 mr-3 flex-shrink-0`}),n.jsxs("div",{className:"flex-1",children:[e&&n.jsx("h3",{className:`${i.text} font-semibold mb-1`,children:e}),n.jsx("p",{className:`${i.text} text-sm`,children:s})]}),t&&n.jsx("button",{onClick:t,className:`${i.text} ml-4 flex-shrink-0 hover:opacity-75`,"aria-label":"Close",children:n.jsx(de,{className:"h-5 w-5"})})]})})},fa=()=>{const[l,e]=j.useState(""),[s,t]=j.useState(""),[r,a]=j.useState(!1),[i,c]=j.useState(""),{signIn:d}=Mt(),h=es(),p=async x=>{x.preventDefault(),a(!0),c("");try{await d(l,s),h("/dashboard")}catch(f){c(f.message||"ログインに失敗しました")}finally{a(!1)}};return n.jsx("div",{className:"min-h-screen bg-white text-gray-900 flex items-center justify-center",children:n.jsx("div",{className:"w-full max-w-md px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"border border-gray-300 rounded-lg bg-white px-6 py-10 sm:px-12 sm:py-14 shadow-sm",children:[n.jsx("h1",{className:"text-lg font-semibold text-gray-800 mb-12 text-center",children:"あるかなライター"}),n.jsxs("div",{className:"w-full",children:[i&&n.jsx(xa,{variant:"error",message:i,onClose:()=>c(""),className:"mb-6"}),n.jsxs("form",{className:"space-y-6",onSubmit:p,children:[n.jsx(fe,{label:"メールアドレス",type:"email",value:l,onChange:x=>e(x.target.value),placeholder:"pxr@example.com",required:!0}),n.jsx(fe,{label:"パスワード",type:"password",value:s,onChange:x=>t(x.target.value),placeholder:"パスワードを入力",required:!0}),n.jsx(H,{type:"submit",className:"w-full",disabled:r,children:r?n.jsxs(n.Fragment,{children:[n.jsx(Ys,{size:"sm",className:"mr-2"}),"ログイン中..."]}):"ログイン"})]}),n.jsx("div",{className:"mt-4 text-sm text-center",children:n.jsx("a",{href:"#",className:"text-gray-700 underline hover:text-gray-900",children:"パスワード忘れた方はこちら"})})]}),n.jsxs("div",{className:"mt-24 sm:mt-28 flex flex-col items-center space-y-2 text-sm text-gray-600",children:[n.jsx(ae,{to:"#",className:"underline hover:text-gray-800",children:"アルカナライター テスター希望はこちら"}),n.jsx(ae,{to:"#",className:"underline hover:text-gray-800",children:"利用規約"}),n.jsx("p",{className:"text-xs uppercase tracking-wide",children:"PxR LLC."})]}),n.jsx("div",{className:"mt-6 text-center",children:n.jsx(ae,{to:"#",className:"text-xs text-gray-500 underline hover:text-gray-700",children:"フォームへリンク"})})]})})})},ga=()=>{const[l,e]=j.useState(""),[s,t]=j.useState(""),[r,a]=j.useState(""),[i,c]=j.useState(""),[d,h]=j.useState(!1),[p,x]=j.useState(!1),[f,y]=j.useState(!1),[M,R]=j.useState(""),{signUp:W}=Mt(),Z=es(),P=async I=>{if(I.preventDefault(),y(!0),R(""),s!==r){R("パスワードが一致しません"),y(!1);return}if(s.length<6){R("パスワードは6文字以上で入力してください"),y(!1);return}try{await W(l,s,i),Z("/dashboard")}catch(L){R(L.message||"アカウント作成に失敗しました")}finally{y(!1)}};return n.jsx("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx(Zt,{className:"h-12 w-12 text-primary-600"})}),n.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"新規アカウント作成"}),n.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["または"," ",n.jsx(ae,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"既存のアカウントでログイン"})]})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:P,children:[M&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md text-sm",children:M}),n.jsxs("div",{className:"space-y-4",children:[n.jsx(fe,{label:"表示名",type:"text",value:i,onChange:I=>c(I.target.value),placeholder:"あなたの名前",required:!0}),n.jsx(fe,{label:"メールアドレス",type:"email",value:l,onChange:I=>e(I.target.value),placeholder:"your@email.com",required:!0}),n.jsxs("div",{className:"relative",children:[n.jsx(fe,{label:"パスワード",type:d?"text":"password",value:s,onChange:I=>t(I.target.value),placeholder:"パスワードを入力（6文字以上）",required:!0}),n.jsx("button",{type:"button",className:"absolute right-3 top-8 text-gray-400 hover:text-gray-600",onClick:()=>h(!d),children:d?n.jsx(Ts,{className:"h-5 w-5"}):n.jsx(Es,{className:"h-5 w-5"})})]}),n.jsxs("div",{className:"relative",children:[n.jsx(fe,{label:"パスワード確認",type:p?"text":"password",value:r,onChange:I=>a(I.target.value),placeholder:"パスワードを再入力",required:!0}),n.jsx("button",{type:"button",className:"absolute right-3 top-8 text-gray-400 hover:text-gray-600",onClick:()=>x(!p),children:p?n.jsx(Ts,{className:"h-5 w-5"}):n.jsx(Es,{className:"h-5 w-5"})})]})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{id:"terms",name:"terms",type:"checkbox",required:!0,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),n.jsxs("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-900",children:[n.jsx(ae,{to:"#",className:"text-primary-600 hover:text-primary-500",children:"利用規約"}),"と",n.jsx(ae,{to:"#",className:"text-primary-600 hover:text-primary-500",children:"プライバシーポリシー"}),"に同意します"]})]}),n.jsx("div",{children:n.jsx(H,{type:"submit",className:"w-full",disabled:f,children:f?"アカウント作成中...":"アカウントを作成"})}),n.jsx("div",{className:"text-center",children:n.jsx(ae,{to:"/",className:"text-sm text-gray-600 hover:text-gray-500",children:"ホームに戻る"})})]})]})})};function ba(){return n.jsx(Bn,{children:n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx(vn,{children:n.jsxs(tt,{path:"/",element:n.jsx(Gn,{}),children:[n.jsx(tt,{index:!0,element:n.jsx(Wn,{})}),n.jsx(tt,{path:"login",element:n.jsx(fa,{})}),n.jsx(tt,{path:"register",element:n.jsx(ga,{})}),n.jsx(tt,{path:"editor",element:n.jsx(Kn,{})}),n.jsx(tt,{path:"dashboard",element:n.jsx(ma,{})})]})})})})}Yt.createRoot(document.getElementById("root")).render(n.jsx(S.StrictMode,{children:n.jsx(jn,{children:n.jsx(ba,{})})}));
//# sourceMappingURL=index-o3B3Q9Rz.js.map
